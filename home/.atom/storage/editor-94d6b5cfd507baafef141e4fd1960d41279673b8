{"mode":"editor","version":1,"windowDimensions":{"x":58,"y":22,"width":1382,"height":878},"syntax":{"deserializer":"Syntax","grammarOverridesByPath":{}},"project":{"path":"/Users/bryce/Code/cashline-migration","buffers":[{"text":"<!doctype html>\n<!--[if IE 8]><html class=\"no-js lt-ie9\" lang=\"en\"> <![endif]-->\n<!--[if gt IE 8]><!--> <html class=\"no-js\" lang=\"en\"> <!--<![endif]-->\n<%@ taglib uri=\"http://struts.apache.org/tags-bean\" prefix=\"bean\"%>\n<%@ taglib uri=\"http://struts.apache.org/tags-html\" prefix=\"html\"%>\n<%@ taglib uri=\"http://struts.apache.org/tags-logic\" prefix=\"logic\"%>\n\n<jsp:include page=\"/common/meta-head.jsp\" />\n<body>\n<jsp:useBean id=\"user_session_object\" scope=\"session\" class=\"com.fis.cashlineapp.forms.CashLineForm\"/>\n<jsp:useBean id=\"account\" scope=\"session\" class=\"com.fis.cashlineapp.forms.FinancialAccountForm\"/>\n\n<jsp:include page=\"/common/header.jsp\" />\n  <jsp:include page=\"/common/modal-learn-more.jsp\" />\n  <jsp:include page=\"/common/modal-login.jsp\" />\n  <jsp:include page=\"/common/modal-about.jsp\" />\n\n<!-- Main Content Area with Menu Sidebar -->\n<div class=\"main\">\n\t<div class=\"row\">\n        <jsp:include page=\"/common/navigation.jsp\" />\n\t\t<div class=\"nine medium-9 columns\">\n\t\t\t<div class=\"content\">\n\n                <jsp:include page=\"/common/greeting.jsp\" />\n\t\t\t\t\n\t\t\t\t<!-- Manage ACH Accounts Page Content -->\n\t\t\t\t<h1>Add ACH Account</h1>\n\t\t\t\t<p>Load up for some hot gaming! Complete the information below and click the &quot;Add Account&quot; button to add a new ACH account. If you need to remove an account, click &quot;Manage ACH Accounts&quot; below.</p>\n\n                <html:form action=\"manageAccounts.do?method=add&sid=<%= user_session_object.getSessionID() %>\" method=\"post\">\n\t\t\t\t\t<fieldset>\n\t\t\t\t\t\t<legend>Bank Account Information</legend>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label>Routing Number\n\t\t\t\t\t\t\t\t    <input type=\"text\" name=\"routingNumber\" placeholder=\"Routing Number\"/>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label>Verify Routing Number\n\t\t\t\t\t\t\t\t    <input type=\"text\" name=\"verifyRoutingNumber\" placeholder=\"Verify Routing Number\">\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label>Account Number\n\t\t\t\t\t\t\t\t<input type=\"text\" name=\"accountNumber\" placeholder=\"Account Number\">\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label>Verify Account Number\n\t\t\t\t\t\t\t\t<input type=\"text\" name=\"verifyAccountNumber\" placeholder=\"Verify Account Number\">\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns end\">\n\t\t\t\t\t\t\t\t<label>\n                                    Account Type\n                                    <select name=\"accountType\">\n                                        <option value='Checking' >Checking</option>\n                                        <option value='Savings' >Savings</option>\n                                        <option value='Business Checking' >Business Checking</option>\n                                        <option value='Business Savings' >Business Savings</option>\n                                    </select>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</fieldset>\n\t\t\t\t\t<fieldset>\n\t\t\t\t\t\t<legend>Security Information</legend>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<p>Please enter the security code shown.</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<p>Need security code plugin here.</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns end\">\n\t\t\t\t\t\t\t\t<label>Security Code<span class=\"required\">*</span>\n\t\t\t\t\t\t\t\t<input type=\"text\" name=\"securitycode\" placeholder=\"Security Code\">\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</fieldset>\n\t\t\t\t\t<div class=\"text-center\">\n\t\t\t\t\t\t<input class=\"button round success\" type=\"submit\" value=\"Add Account\">\n\t\t\t\t\t\t<a href=\"manage-ach-accounts.jsp\" class=\"button round\">Manage ACH Accounts</a>\n\t\t\t\t\t</div>\n                </html:form>\n\t\t\t\t<hr />\n\t\t\t\t<div class=\"text-center\">\n\t\t\t\t\t<a href=\"welcome.jsp\" class=\"button round\">View Limit and Balance</a>\n\t\t\t\t\t<a href=\"change-password.jsp\" class=\"button round\">Change Password</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n\n  <jsp:include page=\"common/footer.jsp\" />\n\n<jsp:include page=\"/common/meta-foot.jsp\" />\n\n  </body>\n</html>\n","markers":{"markers":{"1":{"id":1,"range":[[0,0],[110,0]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":65,"goalBufferRange":null,"autoscroll":false},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[],"redoStack":[],"deserializer":"History"},"filePath":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/WebContent/add-ach-account.jsp","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"f61b7b1eb7e21e354660557fef737538aad94809","deserializer":"TextBuffer"},{"text":"<!doctype html>\n<!--[if IE 8]><html class=\"no-js lt-ie9\" lang=\"en\"> <![endif]-->\n<!--[if gt IE 8]><!--> <html class=\"no-js\" lang=\"en\"> <!--<![endif]-->\n<%@ taglib prefix=\"html\" uri=\"http://struts.apache.org/tags-html\" %>\n<jsp:include page=\"/common/meta-head.jsp\" />\n<body>\n\n<jsp:include page=\"/common/header.jsp\" />\n<jsp:include page=\"/common/modal-learn-more.jsp\" />\n<jsp:include page=\"/common/modal-login.jsp\" />\n<jsp:include page=\"/common/modal-about.jsp\" />\n\n\n<!-- Main Content Area with Menu Sidebar -->\n<div class=\"main\">\n    <div class=\"row\">\n        <jsp:include page=\"/common/navigation.jsp\" />\n\t\t<div class=\"nine medium-9 columns\">\n            <div class=\"content\">\n                <!-- Enroll Now Conditions Page Content -->\n                <h1>Conditions and Terms of Use</h1>\n                <h3>1. ACCEPTANCE OF TERMS</h3>\n                <p>Certegy&reg; provides the Certegy services (defined below) to you subject to the following Terms of Service (&quot;TOS&quot;), which may be updated by us from time to time without notice to you. By accessing and using the Certegy services, you accept and agree to be bound by the terms and provisions of the TOS. In addition, when using particular Certegy owned or operated services, you and Certegy shall be subject to any posted guidelines or rules applicable to such services, which may be posted and modified from time to time.</p>\n                <h3>2. SERVICE DESCRIPTION AND AUTHORIZATION</h3>\n                <p>At Certegy, we are proud to offer innovative funds-availability solutions for gaming establishments. Certegy assists gaming establishments with the cashing of checks and associated check cashing risk management. Upon enrollment in Certegy CashLine, you will have access to a personal10-day revolving CashLine limit tied directly to your checking account. After your initial enrollment, you will no longer need to present a check to access funds from your checking account. Simply present your State Issued ID to the cashier and the requested amount will be deducted from your 10-day CashLine limit. You understand that if you are approved for a specified dollar amount with the CashLine program, that amount represents a 10-calendar day revolving check cashing limit that will be authorized at all gaming establishments that participate in the Certegy Network. Each check presented within a revolving 10-calendar day period will be deducted from the established check cashing limit. After a 10-calendar day period, an approved item will be removed and the amount will be included in the available check cashing balance. Certegy is not a check casher and the CashLine program does not mean you have been granted a line of credit; you understand that each individual check must still be authorized. In addition, you authorize Certegy to obtain information from your consumer report. Certegy will use this information for qualification to the CashLine program. Certegy reserves the right to deny any check transaction if all approval criteria are not met. Certegy will perform periodic reviews of your check cashing history and consumer report to evaluate my CashLine limit. You hereby authorize these procedures and understand that a review of your account may result in an increase, decrease, or revocation of your check cashing privileges at gaming establishments that participate in the Certegy Network.</p>\n                <h3>3. YOUR REGISTRATION OBLIGATIONS</h3>\n                <p>In consideration of your use of the Certegy services, you represent that you are of legal age to form a binding contract and are not a person barred from receiving the Certegy services under the laws of the United States or other applicable jurisdiction. You also agree to: (a) provide true, accurate, current and complete information about yourself as prompted by the Certegy services registration form (the &quot;Registration Data&quot;) and (b) maintain and promptly update the Registration Data to keep it true, accurate, current and complete. If you provide any information that is untrue, inaccurate, not current or incomplete, or Certegy has reasonable grounds to suspect that such information is untrue, inaccurate, not current or incomplete, Certegy has the right to suspend or terminate your account, with or without prior notice, and refuse any and all current or future use of the Certegy services (or any portion thereof). Certegy is concerned about the safety and privacy of all its users. When you create an account, you certify that you are at least 18 years old.</p>\n                <h3>4. CERTEGY <a name=\"privacy_policy\" id=\"privacy_policy\">PRIVACY POLICY</a></h3>\n                <p>Registration Data and certain other information about you are subject to our applicable privacy policy. You understand that through your use of Certegy services you consent to the collection and use (as set forth in the applicable privacy policy) of this information, including the transfer of this information to the United States and/or other countries for storage, processing and use.</p>\n                <h3>5. MEMBER ACCOUNT, PASSWORD AND SECURITY</h3>\n                <p>You will receive a password and account designation upon completing the Certegy services registration process. You are responsible for maintaining the confidentiality of the password and account and are fully responsible for all activities that occur under your password or account. You agree to (a) immediately notify Certegy of any unauthorized use of your password or account or any other breach of security, and (b) ensure that you exit from your account at the end of each session. Certegy cannot and will not be liable for any loss or damage arising from your failure to comply with this Section 5.</p>\n                <h3>6. COPYRIGHT NOTICES</h3>\n                <p>The works of authorship contained in the Certegy.com Website (the \"Website\"), including but not limited to all design, text, sound recordings and images, are owned, except as otherwise expressly stated, by Certegy or one of its affiliates, (\"Certegy\"). Except as otherwise expressly stated herein, they may not be copied, transmitted, displayed, performed, distributed (for compensation or otherwise), licensed, altered, framed, stored for subsequent use or otherwise used in whole or in part in any manner without Certegy&apos;s prior written consent, except to the extent permitted by the Copyright Act of 1976 (17 U.S.C. &sect; 107), as amended, and then, only with notices of Certegy's proprietary rights provided that you may download information and print out hard copies for your personal use, so long as you do not remove any copyright or other notice as may be contained in information, as downloaded.</p>\n                <h3>7. TRADEMARK NOTICES</h3>\n                <p>Certegy CashLine is the marketing name for the funds-availability solutions of Certegy and its subsidiaries and affiliates in the United States. \"Certegy,\" the Certegy logo is a trademark of Certegy. Other featured words or symbols, used to identify the source of goods and services, may be the trademarks of their respective owners.</p>\n                <h3>8. POTENTIAL DISRUPTION OF SERVICE</h3>\n                <p>Access to the Website may from time to time be unavailable, delayed, limited or slowed due to, among other things:</p>\n                <ol>\n                    <li>* hardware failure, including among other things failures of computers (including your own computer), servers, networks, telecommunication lines and connections, and other electronic and mechanical equipment;\n                    <li>* software failure, including among other things, bugs, errors, viruses, configuration problems, incompatibility of systems, utilities or applications, the operation of firewalls or screening programs, unreadable codes, or irregularities within particular documents or other content;\n                    <li>* overload of system capacities;\n                    <li>* damage caused by severe weather, earthquakes, wars, insurrection, riots, civil commotion, act of God, accident, fire, water damage, explosion, mechanical breakdown or natural disasters;\n                    <li>* interruption (whether partial or total) of power supplies or other utility of service;\n                    <li>* strike or other stoppage (whether partial or total) of labor;\n                    <li>* governmental or regulatory restrictions, exchange rulings, court or tribunal orders or other human intervention; or\n                    <li>* any other cause (whether similar or dissimilar to any of the foregoing) whatsoever beyond the control of Certegy.</li>\n                </ol>\n                <h3>9. NO COMMERCIAL REUSE OF CERTEGY SERVICES</h3>\n                <p>You agree not to reproduce, duplicate, copy, sell, trade, resell or exploit for any commercial purposes, any portion or use of, or access to, the Certegy services (including Content, Advertisements, Software and your Certegy ID).</p>\n                <h3>10. MODIFICATIONS TO CERTEGY SERVICES</h3>\n                <p>Certegy reserves the right at any time and from time to time to modify, suspend, or discontinue, temporarily or permanently, the Certegy services (or any part thereof) with or without notice. You agree that Certegy shall not be liable to you or to any third party for any modification, suspension or discontinuance of the Certegy services (or any part thereof).</p>\n                <h3>11. ACH AUTHORIZATION</h3>\n                <p>You authorize Certegy to initiate debit and credit entries to the checking account at the depository financial institution for which you have provided information. The debit for a transaction can post at your financial institution within 24 hours from the time you initiate a transaction.  You further authorize all transactions at any participating Certegy client to be debited from the same checking account, and such future debits will take place only when initiated by you and a receipt will be provided by the participating Certegy client for each debit you initiate for the account. Your authorization will remain in effect until Certegy has received written notification by you of its termination and up to thirty (30) days has been allowed to process the request. You understand that checks or debits returned unpaid by your financial institution are subject to a service charge which also may be debited electronically from your account or collected using a bank draft drawn from your account.</p>\n                <h3>12. TERMINATION</h3>\n                <p>You may terminate your Certegy account, and access to the Certegy services by submitting such termination request to Certegy. Our contact information is provided below in order to perform a termination request: Certegy Check Services, Inc. P.O. Box 30296 Tampa, FL 33630-3296, 1-866-740-3276. You agree that Certegy may, with or without prior notice, immediately terminate, limit your access to or suspend your Certegy account and access to the Certegy Services. Cause for such termination, limitation of access or suspension shall include, but not be limited to, (a) breaches or violations of the TOS or other incorporated agreements or guidelines, (b) requests by law enforcement or other government agencies, (c) discontinuance or material modification to the Certegy services (or any part thereof), (d) unexpected technical or security issues or problems, (e) extended periods of inactivity, (f) engagement by you in fraudulent or illegal activities, and/or (g) nonpayment of any fees owed by you in connection with the Certegy Services. Further, you agree that all terminations, limitations of access and suspensions for cause shall be made in Certegy&apos;s sole discretion and that Certegy shall not be liable to you or any third party for any termination of your account or access to the Certegy Services. Termination of your Certegy account includes any or all of the following: (a) removal of access to all or part of the offerings within the Certegy services, (b) deletion of your password and all related information, files and content associated with or inside your account (or any part thereof), and (c) barring of further use of all or part of the Certegy services.</p>\n                <h3>13. LINKS</h3>\n                <p>The Certegy services may provide, or third parties may provide, links to other World Wide Web sites or resources. You acknowledge and agree that Certegy is not responsible for the availability of such external sites or resources, and does not endorse and is not responsible or liable for any Content, advertising, products or other materials on or available from such sites or resources. You further acknowledge and agree that Certegy shall not be responsible or liable, directly or indirectly, for any damage or loss caused or alleged to be caused by or in connection with use of or reliance on any such Content, goods or services available on or through any such site or resource.</p>\n                <h3>14. LIMITATION OF LIABILITY</h3>\n                <p>You expressly understand and agree that Certegy and its subsidiaries, affiliates, officers, employees, agents, partners and licensors shall not be liable to you for any direct, indirect, incidental, special, punitive, consequential or exemplary damages, under any cause of action or theory of liability (including negligence), and whether or not Certegy has been advised of the possibility of such damage, resulting from: (a) the use or the inability to use the Certegy service; (b) the cost of procurement of substitute goods and services; (c) unauthorized access to or alteration of your transmissions or data; (d) statements or conduct of any third party on the Certegy service; or (e) any other matter relating to the Certegy service.</p>\n                <h3>15. ARBITRATION</h3>\n                <p>Any dispute arising out of or relating to the TOS or the Certegy services, regarding Certegy or any affiliate, shall be finally resolved by arbitration administered by the American Arbitration Association under its Commercial Arbitration Rules, and judgment upon the award rendered by the arbitrator may be entered in any court having jurisdiction. The arbitration will be conducted in the English language in accordance with the United States Arbitration Act. There shall be one arbitrator, named in accordance with such rules. The arbitrator shall decide the dispute in accordance with the substantive law of the state of Florida. The award of the arbitrator shall be accompanied by a statement of the reasons upon which the award is based. Any arbitration arising out of the TOS or the Certegy services shall proceed solely on an individual basis without the right for any claims to be arbitrated on a class action basis or on bases involving claims brought in a purported representative capacity on behalf of others. Claims may not be joined or consolidated unless agreed to in writing by all parties. No award or decision will have any preclusive effect as to issues or claims in any dispute with anyone who is not a named party to the arbitration.</p>\n                <h3>16. NOTICE</h3>\n                <p>Certegy may provide you with notices, including those regarding changes to the TOS, including by but not limited to email, regular mail, SMS, MMS, text message, postings on the Certegy services, or other reasonable means now known or hereafter developed. Such notices may not be received if you violate this TOS by accessing the Certegy services in an unauthorized manner. You further expressly authorize Certegy and its affiliates to contact you, via auto-dialer, pre-recorded messages, or any other method, on any of your mobile phone numbers or emails. Your agreement to this TOS constitutes your agreement that you are deemed to have received any and all notices that would have been delivered had you accessed the Certegy services in an authorized manner.</p>\n                <html:form action=\"/enrollDisplay\" method=\"post\">\n                    <p>\n                        <html:checkbox styleId=\"agreement\" styleClass=\"ie8-checkbox\" property=\"npiConsumerAcceptance\" onclick=\"agree(this.checked);\" /><label for=\"agreement\">I Agree</label>\n                    </p>\n                    <p>\n                        <html:submit styleClass=\"button round\" property=\"method\" value=\"Continue\" disabled=\"true\"></html:submit>\n                    </p>\n                </html:form>\n            </div>\n        </div>\n    </div>\n</div>\n\n<script type=\"text/javascript\">\n    document.onload = function(){\n        document.getElementById(\"agreement\").setAttribute(\"checked\", \"false\");\n    }\n    function agree(checked) {\n        document.getElementsByName(\"method\")[0].disabled = !checked;\n    }\n    function submitAgreement() {\n        document.forms[0].action = \"enrollDisplay.do?method=Load\";\n        document.forms[0].submit();\n    }\n</script>\n<jsp:include page=\"common/footer.jsp\" />\n\n<jsp:include page=\"/common/meta-foot.jsp\" />\n</body>\n</html>\n","markers":{"markers":{"1":{"id":1,"range":[[0,0],[93,0]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":69,"goalBufferRange":null,"autoscroll":false},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[],"redoStack":[],"deserializer":"History"},"filePath":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/WebContent/enrollAgreement.jsp","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"eb773a5ac203a7011e59bb7bed6dbb74bcc2fa70","deserializer":"TextBuffer"},{"text":"<!doctype html>\n<!--[if IE 8]><html class=\"no-js lt-ie9\" lang=\"en\"> <![endif]-->\n<!--[if gt IE 8]><!--> <html class=\"no-js\" lang=\"en\"> <!--<![endif]-->\n<%@ taglib uri=\"http://struts.apache.org/tags-bean\" prefix=\"bean\"%>\n<%@ taglib uri=\"http://struts.apache.org/tags-html\" prefix=\"html\"%>\n<%@ taglib uri=\"http://struts.apache.org/tags-logic\" prefix=\"logic\"%>\n<%@ taglib prefix=\"email\" uri=\"/WEB-INF/Email.tld\" %>\n<%@ taglib prefix=\"text2\" uri=\"/WEB-INF/Text2.tld\" %>\n\n<jsp:useBean id=\"merchantViewHelper\" scope=\"session\" class=\"com.fis.cashlineapp.helper.MerchantPresentationHelper\" />\n<jsp:useBean id=\"user_session_object\" scope=\"session\" class=\"com.fis.cashlineapp.forms.CashLineForm\"/>\n<jsp:useBean id=\"enrollForm\" scope=\"session\" class=\"com.fis.cashlineapp.forms.EnrollForm\"/>\n<jsp:useBean id=\"enrollHelper\" scope=\"session\" class=\"com.fis.cashlineapp.helper.EnrollHelper\" />\n<jsp:useBean id=\"welcomeHelper\" scope=\"session\" class=\"com.fis.cashlineapp.helper.WelcomeHelper\" />\n\n<jsp:include page=\"/common/meta-head.jsp\" />\n<body>\n\n<jsp:include page=\"/common/header.jsp\" />\n  <jsp:include page=\"/common/modal-learn-more.jsp\" />\n  <jsp:include page=\"/common/modal-login.jsp\" />\n  <jsp:include page=\"/common/modal-about.jsp\" />\n\n<!-- Main Content Area with Menu Sidebar -->\n<div class=\"main\">\n\t<div class=\"row\">\n    <jsp:include page=\"/common/navigation.jsp\" />\n\n    <div class=\"nine medium-9 columns\">\n\t\t\t<div class=\"content\">\n\t\t\t\t<!-- Enroll Now Form Page Content -->\n\t\t\t\t<h1>CERTEGY<sup>&reg;</sup> CashLine Enrollment Request Form</h1>\n\t\t\t\t<p>Please enter enrollment fields and click &quot;Next&quot; button. Required fields are marked with an asterisk (<span class=\"required\">*</span>).</p>\n                <logic:messagesPresent>\n                    <logic:notEmpty property=\"actionMessage\" name=\"enrollForm\">\n                        <div class=\"body_text\" style=\"padding-bottom: 8px\">\n                            <bean:write name=\"enrollForm\" property=\"actionMessage\" filter=\"false\" />\n                        </div>\n                        <br>\n                        <br>\n                    </logic:notEmpty>\n                    <logic:empty property=\"actionMessage\" name=\"enrollForm\">\n                        <div class=\"form_field_error_header\">\n                            <bean:message key=\"enroll.errors\" />\n                        </div>\n                        <html:errors/>\n                    </logic:empty>\n                </logic:messagesPresent>\n                <html:form action=\"enrollPerform.do\" method=\"post\">\n                    <html:javascript formName=\"enrollForm\"/>\n                    <input type=\"hidden\" name=\"mid\" value=\"6\"/>\n                    <input type=\"hidden\" name=\"transactionOrigin\" value=\"someOrig\"/>\n                    <logic:notEmpty property=\"loginInfo\" name=\"enrollForm\">\n                    \t<h3>We've done this before</h3>\n                    </logic:notEmpty>\n\t\t\t\t\t<fieldset>\n\t\t\t\t\t\t<legend>Personal Information</legend>\n\t\t\t\t\t\t<p>Please provide your Full Legal Name</p>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"three medium-3 columns\">\n                                <label <logic:messagesPresent property=\"firstName\">class=\"error\"</logic:messagesPresent>>First<span class=\"required\">*</span>\n                                    <html:text property=\"firstName\"></html:text>\n\n         </label>\n                                <logic:messagesPresent property=\"firstName\">\n                                    <small class=\"error\"><html:errors property=\"firstName\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n                            <div class=\"three medium-3 columns\">\n                                <label>Middle\n                                \t<html:text property=\"middleName\"></html:text>\n                                </label>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\"four medium-4 columns\">\n                                <label <logic:messagesPresent property=\"firstName\">class=\"error\"</logic:messagesPresent>>Last<span class=\"required\">*</span>\n                                <logic:notEmpty property=\"loginInfo\" name=\"enrollForm\">\n                                \t<bean:write name=\"enrollForm\" property=\"lastName\"/>\n                                </logic:notEmpty>\n                                <logic:empty property=\"loginInfo\" name=\"enrollForm\">\n                                \t<html:text property=\"lastName\"></html:text>\n                                </logic:empty>\n                                </label>\n                                <logic:messagesPresent property=\"lastName\">\n                                    <small class=\"error\"><html:errors property=\"lastName\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\"two medium-2 columns\">\n\t\t\t\t\t\t\t\t<label>Suffix\n\t\t\t\t\t\t\t\t\t<html:select property=\"suffix\">\n\t\t\t\t\t\t\t\t\t\t<html:option value=\"Jr.\">Jr.</html:option>\n\t\t\t\t\t\t\t\t\t\t<html:option value=\"Sr.\">Sr.</html:option>\n\t\t\t\t\t\t\t\t\t\t<html:option value=\"2nd\">2nd</html:option>\n\t\t\t\t\t\t\t\t\t\t<html:option value=\"3rd\">3rd</html:option>\n\t\t\t\t\t\t\t\t\t\t<html:option value=\"II\">II</html:option>\n\t\t\t\t\t\t\t\t\t\t<html:option value=\"III\">III</html:option>\n\t\t\t\t\t\t\t\t\t\t<html:option value=\"IV\">IV</html:option>\n\t\t\t\t\t\t\t\t\t\t<html:option value=\"V\">V</html:option>\n\t\t\t\t\t\t\t\t\t\t<html:option value=\"VI\">VI</html:option>\n\t\t\t\t\t\t\t\t\t</html:select>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"four medium-4 columns end\">\n\t\t\t\t\t\t\t\t<label  <logic:messagesPresent property=\"dob\">class=\"error\"</logic:messagesPresent> >Date of Birth<span class=\"required\">*</span>\n                                    <div class=\"row\">\n                                        <div class=\"three medium-3 columns end\">\n                                        \t<html:text property=\"dobMm\" maxlength=\"3\" ></html:text>\n                                        </div>\n                                        <div class=\"three medium-3 columns end\">\n                                        \t<html:text property=\"dobDd\" maxlength=\"2\" ></html:text>\n                                        </div>\n                                        <div class=\"siz medium-6 columns end\">\n                                        \t<html:text property=\"dobYyyy\" maxlength=\"4\" ></html:text>\n                                        </div>\n                                    </div>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"dob\">\n                                    <small class=\"error\"><html:errors property=\"dob\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label  <logic:messagesPresent property=\"driversLicense\">class=\"error\"</logic:messagesPresent> >State Issued ID Number<span class=\"required\">*</span>\n\t\t\t\t\t\t\t\t<html:text property=\"driversLicense\" ></html:text>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"driversLicense\">\n                                    <small class=\"error\"><html:errors property=\"driversLicense\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label  <logic:messagesPresent property=\"verifyDriversLicense\">class=\"error\"</logic:messagesPresent> >Verify State Issued ID Number<span class=\"required\">*</span>\n\t\t\t\t\t\t\t\t<html:text property=\"verifyDriversLicense\" ></html:text>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"verifyDriversLicense\">\n                                    <small class=\"error\"><html:errors property=\"verifyDriversLicense\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label  <logic:messagesPresent property=\"dlState\">class=\"error\"</logic:messagesPresent> >State of Issuance<span class=\"required\">*</span>\n\n\t\t\t\t\t\t\t\t<html:select property=\"dlState\">\n\n\t   \t\t\t\t\t\t\t\t<html:option value='Alabama' >Alabama</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Alaska' >Alaska</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Arizona' >Arizona</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Arkansas' >Arkansas</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='California' >California</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Colorado' >Colorado</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Connecticut' >Connecticut</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Delaware' >Delaware</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='District of Columbia' >District of Columbia</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Florida' >Florida</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Georgia' >Georgia</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Hawaii' >Hawaii</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Idaho' >Idaho</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Illinois' >Illinois</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Indiana' >Indiana</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Iowa' >Iowa</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Kansas' >Kansas</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Kentucky' >Kentucky</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Louisiana' >Louisiana</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Maine' >Maine</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Maryland' >Maryland</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Massachusetts' >Massachusetts</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Michigan' >Michigan</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Minnesota' >Minnesota</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Mississippi' >Mississippi</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Missouri' >Missouri</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Montana' >Montana</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Nebraska' >Nebraska</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Nevada' >Nevada</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='New Hampshire' >New Hampshire</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='New Jersey' >New Jersey</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='New Mexico' >New Mexico</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='New York' >New York</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='North Carolina' >North Carolina</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='North Dakota' >North Dakota</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Ohio' >Ohio</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Oklahoma' >Oklahoma</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Oregon' >Oregon</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Pennsylvania' >Pennsylvania</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Rhode Island' >Rhode Island</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='South Carolina' >South Carolina</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='South Dakota' >South Dakota</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Tennessee' >Tennessee</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Texas' >Texas</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Utah' >Utah</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Vermont' >Vermont</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Virginia' >Virginia</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Washington' >Washington</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='West Virginia' >West Virginia</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Wisconsin' >Wisconsin</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Wyoming' >Wyoming</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Armed Forces Americas' >Armed Forces Americas</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Armed Forces Europe' >Armed Forces Europe</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Armed Forces Pacific' >Armed Forces Pacific</html:option>\n\n\t\t\t\t\t\t\t\t</html:select>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"dlState\">\n                                    <small class=\"error\"><html:errors property=\"dlState\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"four medium-4 columns end\">\n\t\t\t\t\t\t\t\t<label  <logic:messagesPresent property=\"expiryDate\">class=\"error\"</logic:messagesPresent> >Expiration Date<span class=\"required\">*</span>\n\n                                    <div class=\"row\">\n                                        <div class=\"three medium-3 columns end\">\n\t\t\t\t\t\t\t\t\t\t\t<html:text property=\"dlMm\" maxlength=\"3\" ></html:text>\n                                        </div>\n                                        <div class=\"three medium-3 columns end\">\n                                            <html:text property=\"dlDd\" maxlength=\"2\" ></html:text>\n                                        </div>\n                                        <div class=\"siz medium-6 columns end\">\n                                            <html:text property=\"dlYyyy\" maxlength=\"4\" ></html:text>\n                                        </div>\n                                    </div>\n                                </label>\n\n                                <logic:messagesPresent property=\"expiryDate\">\n                                    <small class=\"error\"><html:errors property=\"expiryDate\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"four medium-4 columns\">\n\t\t\t\t\t\t\t\t<label <logic:messagesPresent property=\"ssn1\">class=\"error\"</logic:messagesPresent>>Social Security Number\n                                    <div class=\"row\">\n                                        <div class=\"three medium-3 columns end\">\n                                        \t<html:text property=\"ssn11\" maxlength=\"3\" ></html:text>\n                                        </div>\n                                        <div class=\"three medium-3 columns end\">\n                                            <html:text property=\"ssn12\" maxlength=\"2\" ></html:text>\n                                        </div>\n                                        <div class=\"siz medium-6 columns end\">\n                                        \t<html:text property=\"ssn13\" maxlength=\"4\" ></html:text>\n                                        </div>\n                                    </div>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"ssn1\">\n                                    <small class=\"error\"><html:errors property=\"ssn1\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"four medium-4 columns\">\n\t\t\t\t\t\t\t\t<label <logic:messagesPresent property=\"ssn2\">class=\"error\"</logic:messagesPresent>>Verify Social Security Number\n                                    <div class=\"row\">\n                                        <div class=\"three medium-3 columns end\">\n                                        \t<html:text property=\"ssn21\" maxlength=\"3\" ></html:text>\n                                        </div>\n                                        <div class=\"three medium-3 columns end\">\n                                            <html:text property=\"ssn22\" maxlength=\"2\" ></html:text>\n                                        </div>\n                                        <div class=\"siz medium-6 columns end\">\n                                        \t<html:text property=\"ssn23\" maxlength=\"4\" ></html:text>\n                                        </div>\n                                    </div>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"ssn2\">\n                                    <small class=\"error\"><html:errors property=\"ssn2\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"four medium-4 columns\">\n\t\t\t\t\t\t\t\t<p class=\"disclaimer\">Note: Your Social Security Number is not required for approval, but if entered, will typically result in a higher limit.</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns end\">\n\t\t\t\t\t\t\t\t<label>Total Rewards Number\n\t\t\t\t\t\t\t\t<html:text property=\"totalRewardsNo\"></html:text>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</fieldset>\n\t\t\t\t\t<fieldset>\n\t\t\t\t\t\t<legend>Current Address</legend>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label  <logic:messagesPresent property=\"address1\">class=\"error\"</logic:messagesPresent>>Address 1<span class=\"required\">*</span>\n\t\t\t\t\t\t\t\t\t<html:text property=\"address1\"></html:text>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"address1\">\n                                    <small class=\"error\"><html:errors property=\"address1\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label>Address 2\n\t\t\t\t\t\t\t\t<html:text property=\"address2\"></html:text>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"four medium-4 columns\">\n\t\t\t\t\t\t\t\t<label <logic:messagesPresent property=\"city\">class=\"error\"</logic:messagesPresent> >City<span class=\"required\">*</span>\n\t\t\t\t\t\t\t\t<html:text property=\"city\"></html:text>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"city\">\n                                    <small class=\"error\"><html:errors property=\"city\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"three medium-3 columns\">\n\t\t\t\t\t\t\t\t<label  <logic:messagesPresent property=\"state\">class=\"error\"</logic:messagesPresent> >State<span class=\"required\">*</span>\n\n\t\t\t\t\t\t\t\t<html:select property=\"state\">\n\n\t   \t\t\t\t\t\t\t\t<html:option value='Alabama' >Alabama</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Alaska' >Alaska</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Arizona' >Arizona</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Arkansas' >Arkansas</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='California' >California</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Colorado' >Colorado</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Connecticut' >Connecticut</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Delaware' >Delaware</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='District of Columbia' >District of Columbia</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Florida' >Florida</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Georgia' >Georgia</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Hawaii' >Hawaii</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Idaho' >Idaho</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Illinois' >Illinois</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Indiana' >Indiana</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Iowa' >Iowa</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Kansas' >Kansas</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Kentucky' >Kentucky</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Louisiana' >Louisiana</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Maine' >Maine</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Maryland' >Maryland</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Massachusetts' >Massachusetts</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Michigan' >Michigan</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Minnesota' >Minnesota</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Mississippi' >Mississippi</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Missouri' >Missouri</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Montana' >Montana</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Nebraska' >Nebraska</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Nevada' >Nevada</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='New Hampshire' >New Hampshire</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='New Jersey' >New Jersey</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='New Mexico' >New Mexico</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='New York' >New York</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='North Carolina' >North Carolina</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='North Dakota' >North Dakota</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Ohio' >Ohio</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Oklahoma' >Oklahoma</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Oregon' >Oregon</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Pennsylvania' >Pennsylvania</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Rhode Island' >Rhode Island</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='South Carolina' >South Carolina</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='South Dakota' >South Dakota</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Tennessee' >Tennessee</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Texas' >Texas</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Utah' >Utah</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Vermont' >Vermont</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Virginia' >Virginia</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Washington' >Washington</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='West Virginia' >West Virginia</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Wisconsin' >Wisconsin</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Wyoming' >Wyoming</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Armed Forces Americas' >Armed Forces Americas</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Armed Forces Europe' >Armed Forces Europe</html:option>\n\t\t\t\t\t\t\t\t\t<html:option value='Armed Forces Pacific' >Armed Forces Pacific</html:option>\n\n\t\t\t\t\t\t\t\t</html:select>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"state\">\n                                    <small class=\"error\"><html:errors property=\"state\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"three medium-3 columns\">\n\t\t\t\t\t\t\t\t<label <logic:messagesPresent property=\"postalCode\">class=\"error\"</logic:messagesPresent> >Postal Code<span class=\"required\">*</span>\n\t\t\t\t\t\t\t\t<html:text property=\"postalCode\"></html:text>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"postalCode\">\n                                    <small class=\"error\"><html:errors property=\"postalCode\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"two medium-2 columns\">\n\t\t\t\t\t\t\t\t<p class=\"disclaimer\">Note: Only the first 5 digits are required.</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"row\">\n                            <div class=\"six medium-6 columns end\">\n                                <label <logic:messagesPresent property=\"phone\">class=\"error\"</logic:messagesPresent> >Daytime Phone<span class=\"required\">*</span>\n                                    <div class=\"row\">\n                                        <div class=\"three medium-3 columns end\">\n\t                                        <html:text property=\"phoneAreaCode\" maxlength=\"3\"></html:text>\n                                        </div>\n                                        <div class=\"three medium-3 columns end\">\n                                        \t<html:text property=\"phonePrefixCode\" maxlength=\"3\"></html:text>\n                                        </div>\n                                        <div class=\"siz medium-6 columns end\">\n                                        \t<html:text property=\"phoneLocalCode\" maxlength=\"4\"></html:text>\n                                        </div>\n                                    </div>\n                                </label>\n                                <logic:messagesPresent property=\"phone\">\n                                    <small class=\"error\"><html:errors property=\"phone\"/></small>\n                                </logic:messagesPresent>\n                            </div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</fieldset>\n\t\t\t\t\t<fieldset>\n\t\t\t\t\t\t<legend>Bank Account Information</legend>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label <logic:messagesPresent property=\"routingNumber\">class=\"error\"</logic:messagesPresent> >Routing Number\n\t\t\t\t\t\t\t\t<html:text property=\"routingNumber\"></html:text>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"routingNumber\">\n                                    <small class=\"error\"><html:errors property=\"routingNumber\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label <logic:messagesPresent property=\"verifyRoutingNumber\">class=\"error\"</logic:messagesPresent> >Verify Routing Number\n\t\t\t\t\t\t\t\t<html:text property=\"verifyRoutingNumber\"></html:text>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"verifyRoutingNumber\">\n                                    <small class=\"error\"><html:errors property=\"verifyRoutingNumber\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label <logic:messagesPresent property=\"accountNumber\">class=\"error\"</logic:messagesPresent> >Account Number\n\t\t\t\t\t\t\t\t<html:text property=\"accountNumber\"></html:text>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"accountNumber\">\n                                    <small class=\"error\"><html:errors property=\"accountNumber\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label <logic:messagesPresent property=\"verifyAccountNumber\">class=\"error\"</logic:messagesPresent> >Verify Account Number\n\t\t\t\t\t\t\t\t<html:text property=\"verifyAccountNumber\"></html:text>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"verifyAccountNumber\">\n                                    <small class=\"error\"><html:errors property=\"verifyAccountNumber\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns end\">\n\t\t\t\t\t\t\t\t<label>Account Type\n\t\t\t\t\t\t\t\t<html:select property=\"accountType\">\n\t   \t\t\t\t\t\t\t\t<html:option value='Checking' >Checking</html:option>\n\t   \t\t\t\t\t\t\t\t<html:option value='Savings' >Savings</html:option>\n\t   \t\t\t\t\t\t\t\t<html:option value='Business Checking' >Business Checking</html:option>\n\t   \t\t\t\t\t\t\t\t<html:option value='Business Savings' >Business Savings</html:option>\n\t   \t\t\t\t\t\t\t</html:select>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</fieldset>\n\t\t\t\t\t<fieldset>\n\t\t\t\t\t\t<legend>Login Information</legend>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label <logic:messagesPresent property=\"userName\">class=\"error\"</logic:messagesPresent> >User ID<span class=\"required\">*</span>\n\t\t\t\t\t\t\t\t<html:text property=\"userName\"></html:text>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"userName\">\n                                    <small class=\"error\"><html:errors property=\"userName\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label <logic:messagesPresent property=\"emailAddress\">class=\"error\"</logic:messagesPresent> >Email Address\n\t\t\t\t\t\t\t\t<email:email property=\"emailAddress\" placeholder=\"Email Address\"></email:email>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"emailAddress\">\n                                    <small class=\"error\"><html:errors property=\"emailAddress\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"four medium-4 columns\">\n\t\t\t\t\t\t\t\t<label <logic:messagesPresent property=\"password\">class=\"error\"</logic:messagesPresent> >Password<span class=\"required\">*</span>\n\t\t\t\t\t\t\t\t<text2:text type=\"password\" property=\"password\" placeholder=\"Password\"></text2:text>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"password\">\n                                    <small class=\"error\"><html:errors property=\"password\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"four medium-4 columns\">\n\t\t\t\t\t\t\t\t<label <logic:messagesPresent property=\"confirmPassword\">class=\"error\"</logic:messagesPresent> >ConfirmPassword<span class=\"required\">*</span>\n\t\t\t\t\t\t\t\t<text2:text type=\"password\" property=\"confirmPassword\" placeholder=\"Confirm Password\"></text2:text>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"confirmPassword\">\n                                    <small class=\"error\"><html:errors property=\"confirmPassword\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"four medium-4 columns\">\n\t\t\t\t\t\t\t\t<p class=\"disclaimer\">Note: Your Password should be from 8 to 30 characters in length. (This must include at least one numeric digit, one upper case, one lower case and one special character from following !@#$%^+=)</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label <logic:messagesPresent property=\"securityQuestion\">class=\"error\"</logic:messagesPresent> >Security Question<span class=\"required\">*</span>\n\t\t\t\t\t\t\t\t<html:select property=\"securityQuestion\">\n\t\t\t\t\t\t\t\t<html:option value='What was your childhood nickname?' >What was your childhood nickname?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='In what city did you meet your spouse/significant other?' >In what city did you meet your spouse/significant other?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='What is the name of your favorite childhood friend?' >What is the name of your favorite childhood friend?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='What street did you live on in third grade?' >What street did you live on in third grade?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='What is your oldest sibling&apos;s birthday month and year? (e.g., January 1900)' >What is your oldest sibling's birthday month and year? (e.g., January 1900)</html:option>\n\t\t\t\t\t\t\t\t<html:option value='What is the middle name of your oldest child?' >What is the middle name of your oldest child?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='What is your oldest sibling&apos;s middle name?' >What is your oldest sibling's middle name?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='What school did you attend for sixth grade?' >What school did you attend for sixth grade?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='What was your childhood phone number including area code? (e.g., 000-000-0000)' >What was your childhood phone number including area code? (e.g., 000-000-0000)</html:option>\n\t\t\t\t\t\t\t\t<html:option value='What is your oldest cousin&apos;s first and last name?' >What is your oldest cousin's first and last name?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='What was the name of your first stuffed animal?' >What was the name of your first stuffed animal?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='In what city or town did your mother and father meet?' >In what city or town did your mother and father meet?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='Where were you when you had your first kiss?' >Where were you when you had your first kiss?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='What is the first name of the boy or girl that you first kissed?' >What is the first name of the boy or girl that you first kissed?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='What was the last name of your third grade teacher?' >What was the last name of your third grade teacher?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='In what city does your nearest sibling live?' >In what city does your nearest sibling live?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='What is your oldest brother&apos;s birthday month and year? (e.g., January 1900)' >What is your oldest brothers birthday month and year? (e.g., January 1900)</html:option>\n\t\t\t\t\t\t\t\t<html:option value='What is your maternal grandmother&apos;s maiden name?' >What is your maternal grandmother's maiden name?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='In what city or town was your first job?' >In what city or town was your first job?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='What is the name of the place your wedding reception was held?' >What is the name of the place your wedding reception was held?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='What is the name of a college you applied to but didn&apos;t attend?' >What is the name of a college you applied to but didn't attend?</html:option>\n\t\t\t\t\t\t\t\t<html:option value='Where were you when you first heard about 9/11?' >Where were you when you first heard about 9/11?</html:option>\n\t\t\t\t\t\t\t\t</html:select>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"securityQuestion\">\n                                    <small class=\"error\"><html:errors property=\"securityQuestion\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n\t\t\t\t\t\t\t\t<label <logic:messagesPresent property=\"securityAnswer\">class=\"error\"</logic:messagesPresent> >Security Answer<span class=\"required\">*</span>\n\t\t\t\t\t\t\t\t<text2:text type=\"text\" property=\"securityAnswer\" placeholder=\"Security Answer\"></text2:text>\n\t\t\t\t\t\t\t\t</label>\n                                <logic:messagesPresent property=\"securityAnswer\">\n                                    <small class=\"error\"><html:errors property=\"securityAnswer\"/></small>\n                                </logic:messagesPresent>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</fieldset>\n\t\t\t\t\t<fieldset>\n                        <legend>Security Information</legend>\n                        <div class=\"row\">\n\t\t\t\t\t\t\t<div class=\"six medium-6 columns\">\n                                <p>Please enter the security code shown.</p>\n                            </div>\n                            <div class=\"six medium-6 columns\">\n                                <p>\n                                    <bean:message key=\"enroll.enter\" />\n                                    <bean:message key=\"enrollPage.securityCode\" />\n                                    <bean:message key=\"enroll.message1\" />\n                                    <span class=\"required\">*</span>\n                                </p>\n                            </div>\n                            <div class=\"six medium-6 columns\">\n                                <html:text name=\"enrollForm\" property=\"captchaText\" styleClass=\"form_field_large\" tabindex=\"42\" onkeyup=\"enableButtons(this);\" />\n                                <img src=\"Captcha.jpg\" height=\"20\" width=\"100\" border=\"1\">\n                            </div>\n                            <logic:messagesPresent property=\"catpchaMismatch\">\n                                <div class=\"six medium-6 columns error\">\n                                    <html:errors property=\"catpchaMismatch\" />\n                                </div>\n                            </logic:messagesPresent>\n\n                        <%--<table cellpadding=\"0px\" cellspacing=\"0px\">--%>\n                                <%--<tr class=\"form_table_row\">--%>\n                                    <%--<td class=\"label_text\">--%>\n                                        <%--<bean:message key=\"enroll.enter\" />--%>\n                                        <%--<bean:message key=\"enrollPage.securityCode\" />--%>\n                                        <%--<bean:message key=\"enroll.message1\" />--%>\n                                        <%--<span class=\"required\">*</span>--%>\n                                    <%--</td>--%>\n                                    <%--<td class=\"label_text\">--%>\n                                        <%--<html:text name=\"enrollForm\" property=\"captchaText\" styleClass=\"form_field_large\" tabindex=\"42\" onkeyup=\"enableButtons(this);\" />--%>\n                                    <%--</td>--%>\n                                    <%--<td colspan=\"2\">--%>\n                                        <%--<img src=\"Captcha.jpg\" height=\"20\" width=\"100\" border=\"1\">--%>\n                                    <%--</td>--%>\n                                <%--</tr>--%>\n                                <%--<logic:messagesPresent property=\"catpchaMismatch\">--%>\n                                    <%--<tr>--%>\n                                        <%--<td class=\"error\">--%>\n                                            <%--<html:errors property=\"catpchaMismatch\" />--%>\n                                        <%--</td>--%>\n                                    <%--</tr>--%>\n                                <%--</logic:messagesPresent>--%>\n\n                            <%--</table>--%>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</fieldset>\n                    <p>\n                        <html:button styleClass=\"button round secondary\" property=\"method\" value=\"Save\" tabindex=\"45\" />\n                        <html:submit styleClass=\"button round\" property=\"method\" value=\"Next\" tabindex=\"46\"/>\n                    </p>\n                </html:form>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n\n<script type=\"text/javascript\">\n//    function submitTheForm(temp) {\n//        //document.forms[0].action = \"enrollEdit.do?method=Edit&amp;section=\" + temp;\n//        document.forms[0].action = \"enrollPerform.do\"\n//        document.forms[0].submit();\n//    }\n\n    function saveTheForm() {\n        var elem = document.getElementById(\"verifyAccountNumber\"),\n            acctNumber = elem ? elem.value : null;\n        if(acctNumber && acctNumber.length > 0){\n            alert(\"Bank Account Information will not be saved unless the application is submitted.\");\n        }\n        document.forms[0].action = \"enrollSave.do?method=Save\";\n        document.forms[0].submit();\n    }\n\n    function toggleSubmit(checked){\n        if(checked){\n            document.getElementById(\"disabledButton\").style.display = \"none\";\n            document.getElementById(\"enabledButton\").style.display = \"block\";\n        }else\n        {\n            document.getElementById(\"disabledButton\").style.display = \"block\";\n            document.getElementById(\"enabledButton\").style.display = \"none\";\n        }\n    }\n\n    function enableButtons(obj){\n        if(Trim( obj.value).length > 0 ){\n            document.getElementById(\"eButtons\").style.display = \"block\";\n            document.getElementById(\"dButtons\").style.display = \"none\";\n        }else\n        {\n            document.getElementById(\"eButtons\").style.display = \"none\";\n            document.getElementById(\"dButtons\").style.display = \"block\";\n        }\n    }\n\n\n    window.onload=function(){\n        if(document.getElementsByName('captchaText')[0] != null)\n            document.getElementsByName('captchaText')[0].value = \"\";\n        if(document.getElementsByName('cashLineConsumerAcceptance')[0] != null)\n            document.getElementsByName('cashLineConsumerAcceptance')[0].checked = false;\n        if(document.getElementsByName('achConsumerAcceptance')[0] != null)\n            document.getElementsByName('achConsumerAcceptance')[0].checked = false;\n    };\n</script>\n\n<jsp:include page=\"common/footer.jsp\" />\n\n<jsp:include page=\"/common/meta-foot.jsp\" />\n</body>\n</html>\n","markers":{"markers":{"1":{"id":1,"range":[[589,72],[589,72]],"tailed":false,"reversed":true,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":73,"autoscroll":false,"goalBufferRange":null},"deserializer":"Marker"},"20":{"id":20,"range":[[53,0],[53,52]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{},"deserializer":"Marker"},"21":{"id":21,"range":[[54,0],[54,37]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{},"deserializer":"Marker"},"22":{"id":22,"range":[[62,0],[62,0]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{},"deserializer":"Marker"},"23":{"id":23,"range":[[70,0],[70,78]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{},"deserializer":"Marker"},"24":{"id":24,"range":[[80,0],[80,76]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{},"deserializer":"Marker"},"25":{"id":25,"range":[[145,0],[145,0]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{},"deserializer":"Marker"},"26":{"id":26,"range":[[224,0],[224,0]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{},"deserializer":"Marker"},"27":{"id":27,"range":[[260,0],[260,46]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{},"deserializer":"Marker"},"28":{"id":28,"range":[[307,0],[307,0]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{},"deserializer":"Marker"},"29":{"id":29,"range":[[516,0],[516,200]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[{"patches":[{"oldRange":[[589,73],[589,97]],"newRange":[[589,73],[589,73]],"oldText":"onclick=\"saveTheForm();\"","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"id":1,"oldParams":{"tailed":false},"newParams":{"tailed":true},"deserializer":"MarkerPatch"},{"id":1,"oldParams":{"reversed":false,"range":[[589,73],[589,73]]},"newParams":{"reversed":true,"range":[[589,72],[589,73]]},"deserializer":"MarkerPatch"},{"oldRange":[[589,72],[589,73]],"newRange":[[589,72],[589,72]],"oldText":" ","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[307,0],[307,5]],"newRange":[[307,0],[307,0]],"oldText":"\t\t\t\t\t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"oldRange":[[260,46],[260,82]],"newRange":[[260,46],[260,46]],"oldText":"                                    ","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"oldRange":[[224,0],[224,8]],"newRange":[[224,0],[224,0]],"oldText":"\t\t\t\t\t\t\t\t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"oldRange":[[145,0],[145,8]],"newRange":[[145,0],[145,0]],"oldText":"\t\t\t\t\t\t\t\t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"oldRange":[[80,76],[80,77]],"newRange":[[80,76],[80,76]],"oldText":"\t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"oldRange":[[70,78],[70,79]],"newRange":[[70,78],[70,78]],"oldText":"\t","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"oldRange":[[62,0],[62,23]],"newRange":[[62,0],[62,0]],"oldText":"                       ","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"}],"redoStack":[],"deserializer":"History"},"filePath":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/WebContent/enrollForm.jsp","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"6735a1c907eb3b2e2a9715d1fba8d3a6bc7e233d","deserializer":"TextBuffer"},{"text":"package com.fis.cashlineapp.actions;\n\nimport java.text.SimpleDateFormat;\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.HashMap;\nimport java.util.StringTokenizer;\nimport java.util.TimeZone;\nimport java.util.regex.Pattern;\n\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport javax.servlet.http.HttpSession;\n\nimport com.fis.gaming.core.transferobject.ConsumerOtbTO;\nimport com.fis.gaming.core.transferobject.ConsumerTO;\nimport com.fis.gaming.core.transferobject.EnrollTO;\nimport com.fis.gaming.core.transferobject.MerchantTO;\nimport com.fis.gaming.core.transferobject.TxlogTO;\nimport com.fis.gaming.core.util.EncodeUtil;\nimport org.apache.commons.validator.GenericValidator;\nimport org.apache.log4j.Logger;\nimport org.apache.struts.action.ActionErrors;\nimport org.apache.struts.action.ActionForm;\nimport org.apache.struts.action.ActionForward;\nimport org.apache.struts.action.ActionMapping;\nimport org.apache.struts.action.ActionMessage;\nimport org.apache.struts.util.MessageResources;\n\nimport com.fis.cashline.businessdelegate.EnrollBusinessDelegate;\nimport com.fis.cashlineapp.econnect.SCIClientCall;\nimport com.fis.cashlineapp.forms.CashLineForm;\nimport com.fis.cashlineapp.forms.EnrollForm;\nimport com.fis.cashlineapp.forms.SCIClientRequestForm;\nimport com.fis.cashlineapp.forms.SCIClientResponseForm;\nimport com.fis.cashlineapp.helper.EnrollHelper;\nimport com.fis.cashlineapp.helper.MerchantPresentationHelper;\nimport com.fis.cashlineapp.util.ApplicationConstants;\nimport com.fis.cashlineapp.util.MerchantAppValidator;\nimport com.fis.cashlineapp.util.SCIApplicationConstants;\nimport com.fis.gaming.core.exception.CheckServicesException;\n\npublic class EnrollAction extends org.apache.struts.actions.DispatchAction {\n\tpublic static final Logger log = Logger.getLogger(\"EnrollAction\");\n\n    public ActionForward Continue(ActionMapping mapping, ActionForm form, HttpServletRequest request, HttpServletResponse response) throws Exception {\n        return this.Load(mapping, form, request, response);\n    }\n\n    public ActionForward Load(ActionMapping mapping, ActionForm form,\n\t\t\tHttpServletRequest request, HttpServletResponse response)\n\t\t\tthrows Exception {\n\t\tlog.info(\"Entering Load\");\n\t\tActionErrors errors = new ActionErrors();\n\t\tEnrollForm enrollForm = (EnrollForm) form;\n\t\tHttpSession session = request.getSession(true);\n\t\tCashLineForm sessionFormBean = (CashLineForm) session\n\t\t\t\t.getAttribute(ApplicationConstants.SV_USER_SESSION_OBJECT);\n\t\tEnrollHelper enrollHelper = (EnrollHelper) session\n\t\t\t\t.getAttribute(ApplicationConstants.SV_ENROLL_HELPER);\n\t\ttry {\n\n\t\t\tif (sessionFormBean != null\n\t\t\t\t\t&& sessionFormBean.getConsumer() != null) {\n\t\t\t\tenrollForm.setEnrollForm(sessionFormBean.getConsumer());\n\t\t\t\trequest.setAttribute(\"enrollForm\", enrollForm);\n\t\t\t}\n\n\t\t\tif (enrollHelper == null) {\n\t\t\t\tenrollHelper = populateEnrollHelper(new EnrollHelper(), session);\n\t\t\t}\n\n\t\t\tenrollForm.setAchAgreement(enrollHelper.getAchAgreement());\n\t\t\tenrollForm.setCashLineAgreement(enrollHelper.getOtbAgreement());\n\n\t\t} catch (Exception e) {\n\t\t\t// add errors\n\t\t\terrors.add(\"name\", new ActionMessage(\"id\"));\n\t\t\tlog.error(\" EnrollAction Error: \" + e);\n\t\t}\n        ActionForward forward;\n\t\tif (!errors.isEmpty()) {\n\t\t\tsaveErrors(request, errors);\n\t\t\tforward = mapping.findForward(ApplicationConstants.FAIL);\n\t\t} else {\n\t\t\tforward = mapping.findForward(ApplicationConstants.SUCCESS);\n\t\t}\n\t\treturn forward;\n\t}\n\n\tprivate ActionErrors customValidateSave(MessageResources messageResources,\n\t\t\tEnrollForm enrollForm) {\n\t\tActionErrors errors = new ActionErrors();\n\t\tif (enrollForm != null) {\n\t\t\tif (enrollForm.getUserName() == null\n\t\t\t\t\t|| enrollForm.getUserName().trim().length() == 0) {\n\t\t\t\terrors.add(\"userName\", new ActionMessage(\"errors.required\",\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.userID\")));\n\t\t\t}\n\t\t\tif (enrollForm.getPassword() == null\n\t\t\t\t\t|| enrollForm.getPassword().trim().length() == 0) {\n\t\t\t\terrors.add(\"password\", new ActionMessage(\"errors.required\",\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.password\")));\n\t\t\t}\n\t\t\tif (enrollForm.getConfirmPassword() == null\n\t\t\t\t\t|| enrollForm.getConfirmPassword().trim().length() == 0) {\n\t\t\t\terrors.add(\"confirmPassword\", new ActionMessage(\n\t\t\t\t\t\t\"errors.required\", messageResources\n\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.confirmPassword\")));\n\t\t\t} else if (enrollForm.getConfirmPassword() != null\n\t\t\t\t\t&& enrollForm.getPassword() != null\n\t\t\t\t\t&& !enrollForm.getConfirmPassword().equals(\n\t\t\t\t\t\t\tenrollForm.getPassword())) {\n\t\t\t\terrors.add(\"confirmPassword\", new ActionMessage(\n\t\t\t\t\t\t\"error.equalsField\", messageResources\n\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.confirmPassword\"),\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.password\")));\n\t\t\t} else if (enrollForm.getConfirmPassword() != null\n\t\t\t\t\t&& enrollForm.getPassword() != null\n\t\t\t\t\t&& enrollForm.getConfirmPassword().equals(\n\t\t\t\t\t\t\tenrollForm.getPassword())) {\n\t\t\t\tif (!validatePassword(enrollForm.getConfirmPassword())) {\n\t\t\t\t\terrors.add(\"password\", new ActionMessage(\n\t\t\t\t\t\t\t\"error.password.invalid\"));\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (enrollForm.getFirstName() == null\n\t\t\t\t\t|| enrollForm.getFirstName().trim().length() == 0) {\n\t\t\t\terrors.add(\"firstName\", new ActionMessage(\"errors.required\",\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.firstName\")));\n\t\t\t}\n\t\t\tif (enrollForm.getLastName() == null\n\t\t\t\t\t|| enrollForm.getLastName().trim().length() == 0) {\n\t\t\t\terrors.add(\"lastName\", new ActionMessage(\"errors.required\",\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.lastName\")));\n\t\t\t}\n\t\t\tif (enrollForm.getPhone() == null\n\t\t\t\t\t|| enrollForm.getPhone().trim().length() == 0) {\n\t\t\t\terrors.add(\"phone\", new ActionMessage(\"errors.required\",\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.dayPhone\")));\n\t\t\t} else if (enrollForm.getPhone() != null\n\t\t\t\t\t&& enrollForm.getPhone().trim().length() > 0) {\n\t\t\t\tif (!validateNumeric(enrollForm.getPhone())) {\n\t\t\t\t\terrors\n\t\t\t\t\t\t\t.add(\"phone\", new ActionMessage(\"errors.numeric\",\n\t\t\t\t\t\t\t\t\tmessageResources\n\t\t\t\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.dayPhone\")));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn errors;\n\t}\n\n\tprivate ActionErrors validateLoginInfo(MessageResources messageResources,\n\t\t\tEnrollForm enrollForm) {\n\t\tActionErrors errors = new ActionErrors();\n\t\tif (enrollForm != null) {\n\t\t\tif (enrollForm.getUserName() == null\n\t\t\t\t\t|| enrollForm.getUserName().trim().length() == 0) {\n\t\t\t\terrors.add(\"userName\", new ActionMessage(\"errors.required\",\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.userID\")));\n\t\t\t}\n\t\t\tif (enrollForm.getPassword() == null\n\t\t\t\t\t|| enrollForm.getPassword().trim().length() == 0) {\n\t\t\t\terrors.add(\"password\", new ActionMessage(\"errors.required\",\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.password\")));\n\t\t\t}\n\t\t\tif (enrollForm.getConfirmPassword() == null\n\t\t\t\t\t|| enrollForm.getConfirmPassword().trim().length() == 0) {\n\t\t\t\terrors.add(\"confirmPassword\", new ActionMessage(\n\t\t\t\t\t\t\"errors.required\", messageResources\n\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.confirmPassword\")));\n\t\t\t} else if (enrollForm.getConfirmPassword() != null\n\t\t\t\t\t&& enrollForm.getPassword() != null\n\t\t\t\t\t&& !enrollForm.getConfirmPassword().equals(\n\t\t\t\t\t\t\tenrollForm.getPassword())) {\n\t\t\t\terrors.add(\"confirmPassword\", new ActionMessage(\n\t\t\t\t\t\t\"error.equalsField\", messageResources\n\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.confirmPassword\"),\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.password\")));\n\t\t\t} else if (enrollForm.getConfirmPassword() != null\n\t\t\t\t\t&& enrollForm.getPassword() != null\n\t\t\t\t\t&& enrollForm.getConfirmPassword().equals(\n\t\t\t\t\t\t\tenrollForm.getPassword())) {\n\t\t\t\tif (!validatePassword(enrollForm.getConfirmPassword())) {\n\t\t\t\t\terrors.add(\"password\", new ActionMessage(\n\t\t\t\t\t\t\t\"error.password.invalid\"));\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (enrollForm.getSecurityQuestion() == null\n\t\t\t\t\t|| enrollForm.getSecurityQuestion().trim().length() == 0) {\n\t\t\t\terrors.add(\"securityQuestion\", new ActionMessage(\n\t\t\t\t\t\t\"errors.required\", messageResources\n\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.securityQuestion\")));\n\t\t\t}\n\t\t\tif (enrollForm.getSecurityAnswer() == null\n\t\t\t\t\t|| enrollForm.getSecurityAnswer().trim().length() == 0) {\n\t\t\t\terrors.add(\"securityAnswer\", new ActionMessage(\n\t\t\t\t\t\t\"errors.required\", messageResources\n\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.securityAnswer\")));\n\t\t\t}\n\t\t}\n\t\treturn errors;\n\t}\n\n\tprivate ActionErrors validatePersonalInfo(\n\t\t\tMessageResources messageResources, EnrollForm enrollForm) {\n\t\tActionErrors errors = new ActionErrors();\n\t\tif (enrollForm != null) {\n\t\t\tif (enrollForm.getFirstName() == null\n\t\t\t\t\t|| enrollForm.getFirstName().trim().length() == 0) {\n\t\t\t\terrors.add(\"firstName\", new ActionMessage(\"errors.required\",\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.firstName\")));\n\t\t\t}\n\t\t\tif (enrollForm.getLastName() == null\n\t\t\t\t\t|| enrollForm.getLastName().trim().length() == 0) {\n\t\t\t\terrors.add(\"lastName\", new ActionMessage(\"errors.required\",\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.lastName\")));\n\t\t\t}\n\t\t\tif (enrollForm.getValidateDob() == null\n\t\t\t\t\t|| enrollForm.getValidateDob().trim().length() == 0) {\n\t\t\t\terrors.add(\"validateDob\", new ActionMessage(\"errors.required\",\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.dob\")));\n\t\t\t} else if (!validateDateOfBirth(enrollForm.getValidateDob())) {\n\t\t\t\terrors.add(\"validateDob\", new ActionMessage(\n\t\t\t\t\t\t\"errors.DateOfBirth\", messageResources\n\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.dob\")));\n\t\t\t}\n\t\t\tif (enrollForm.getDriversLicense() == null\n\t\t\t\t\t|| enrollForm.getDriversLicense().trim().length() == 0) {\n\t\t\t\terrors.add(\"driversLicense\", new ActionMessage(\n\t\t\t\t\t\t\"errors.required\", messageResources\n\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.USDL\")));\n\t\t\t}\n\t\t\tif (enrollForm.getVerifyDriversLicense() == null\n\t\t\t\t\t|| enrollForm.getVerifyDriversLicense().trim().length() == 0) {\n\t\t\t\terrors.add(\"verifyDriversLicense\", new ActionMessage(\n\t\t\t\t\t\t\"errors.required\", messageResources\n\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.verifyUSDL\")));\n\t\t\t} else if (enrollForm.getVerifyDriversLicense() != null\n\t\t\t\t\t&& enrollForm.getDriversLicense() != null\n\t\t\t\t\t&& !enrollForm.getVerifyDriversLicense().equals(\n\t\t\t\t\t\t\tenrollForm.getDriversLicense())) {\n\t\t\t\terrors.add(\"verifyDriversLicense\", new ActionMessage(\n\t\t\t\t\t\t\"error.equalsField\", messageResources\n\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.verifyUSDL\"),\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.USDL\")));\n\t\t\t}\n\t\t\tif (enrollForm.getDlState() == null\n\t\t\t\t\t|| enrollForm.getDlState().trim().length() == 0) {\n\t\t\t\terrors.add(\"dlState\", new ActionMessage(\"errors.required\",\n\t\t\t\t\t\tmessageResources\n\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.stateInsurance\")));\n\t\t\t}\n\t\t\tif (enrollForm.getValidateExpiry() == null\n\t\t\t\t\t|| enrollForm.getValidateExpiry().trim().length() == 0) {\n\t\t\t\terrors.add(\"validateExpiry\", new ActionMessage(\n\t\t\t\t\t\t\"errors.required\", messageResources\n\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.expiryDate\")));\n\t\t\t} else if (!validateExpiredDate(enrollForm.getValidateExpiry())) {\n\t\t\t\terrors.add(\"validateExpiry\", new ActionMessage(\n\t\t\t\t\t\t\"errors.ExpiredDate\", messageResources\n\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.expiryDate\")));\n\t\t\t}\n\t\t\tif ((enrollForm.getSsn1() != null && enrollForm.getSsn1().trim()\n\t\t\t\t\t.length() != 0)\n\t\t\t\t\t|| (enrollForm.getSsn2() != null && enrollForm.getSsn2()\n\t\t\t\t\t\t\t.trim().length() != 0)) {\n\n\t\t\t\tif (!enrollForm.getSsn2().equals(enrollForm.getSsn1())) {\n\t\t\t\t\terrors\n\t\t\t\t\t\t\t.add(\n\t\t\t\t\t\t\t\t\t\"ssn2\",\n\t\t\t\t\t\t\t\t\tnew ActionMessage(\n\t\t\t\t\t\t\t\t\t\t\t\"error.equalsField\",\n\t\t\t\t\t\t\t\t\t\t\tmessageResources\n\t\t\t\t\t\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.verifySSN\"),\n\t\t\t\t\t\t\t\t\t\t\tmessageResources\n\t\t\t\t\t\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.SSN\")));\n\t\t\t\t} else if (enrollForm.getSsn2() != null\n\t\t\t\t\t\t&& enrollForm.getSsn2().trim().length() != 0\n\t\t\t\t\t\t&& enrollForm.getSsn1() != null\n\t\t\t\t\t\t&& enrollForm.getSsn1().trim().length() != 0\n\t\t\t\t\t\t&& enrollForm.getSsn2().equals(enrollForm.getSsn1())) {\n\t\t\t\t\tif (!validateNumeric(enrollForm.getSsn2())) {\n\t\t\t\t\t\terrors.add(\"ssn1\", new ActionMessage(\"errors.numeric\",\n\t\t\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.SSN\")));\n\t\t\t\t\t} else if (enrollForm.getSsn1().trim().length() != 9) {\n\t\t\t\t\t\terrors.add(\"ssn1\", new ActionMessage(\"errors.size\",\n\t\t\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.SSN\"),\n\t\t\t\t\t\t\t\t\"9\"));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn errors;\n\t}\n\n\tprivate ActionErrors validateAddressInfo(MessageResources messageResources,\n\t\t\tEnrollForm enrollForm) {\n\t\tActionErrors errors = new ActionErrors();\n\t\tif (enrollForm != null) {\n\t\t\tif (enrollForm.getAddress1() == null\n\t\t\t\t\t|| enrollForm.getAddress1().trim().length() == 0) {\n\t\t\t\terrors.add(\"address1\", new ActionMessage(\"errors.required\",\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.addr1\")));\n\t\t\t}\n\t\t\tif (enrollForm.getCity() == null\n\t\t\t\t\t|| enrollForm.getCity().trim().length() == 0) {\n\t\t\t\terrors.add(\"city\", new ActionMessage(\"errors.required\",\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.city\")));\n\t\t\t}\n\t\t\tif (enrollForm.getState() == null\n\t\t\t\t\t|| enrollForm.getState().trim().length() == 0) {\n\t\t\t\terrors.add(\"state\", new ActionMessage(\"errors.required\",\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.state\")));\n\t\t\t}\n\t\t\tif (enrollForm.getPostalCode() == null\n\t\t\t\t\t|| enrollForm.getPostalCode().trim().length() == 0) {\n\t\t\t\terrors.add(\"postalCode\", new ActionMessage(\"errors.required\",\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.postalCode\")));\n\t\t\t} else if (enrollForm.getPostalCode() != null\n\t\t\t\t\t&& enrollForm.getPostalCode().trim().length() != 5) {\n\t\t\t\terrors.add(\"postalCode\", new ActionMessage(\"errors.minlength\",\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.postalCode\"),\n\t\t\t\t\t\t\"5\"));\n\t\t\t}\n\t\t\tif (enrollForm.getPhone() == null\n\t\t\t\t\t|| enrollForm.getPhone().trim().length() == 0) {\n\t\t\t\terrors.add(\"phone\", new ActionMessage(\"errors.required\",\n\t\t\t\t\t\tmessageResources.getMessage(\"enrollPage.dayPhone\")));\n\t\t\t} else if (enrollForm.getPhone() != null\n\t\t\t\t\t&& enrollForm.getPhone().trim().length() > 0) {\n\t\t\t\tif (!validateNumeric(enrollForm.getPhone())) {\n\t\t\t\t\terrors\n\t\t\t\t\t\t\t.add(\"phone\", new ActionMessage(\"errors.numeric\",\n\t\t\t\t\t\t\t\t\tmessageResources\n\t\t\t\t\t\t\t\t\t\t\t.getMessage(\"enrollPage.dayPhone\")));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn errors;\n\t}\n\n\tprivate boolean validatePassword(String password) {\n\t\tif (password\n\t\t\t\t.matches(\"^(?=.{8,})(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^+=]).*$\")) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tprivate boolean validateNumeric(String number) {\n\t\tif (Pattern.matches(\"[0-9]+\", number))\n\t\t\treturn true;\n\t\telse\n\t\t\treturn false;\n\t}\n\n\tprivate boolean validateDateOfBirth(String value) {\n\t\tif (!MerchantAppValidator.isThisDateValid(value, \"MM/dd/yyyy\"))\n\t\t\treturn false;\n\t\tboolean valid = true;\n\t\tint minAge = 18;\n\t\tint maxAge = 150;\n\t\tif (!GenericValidator.isBlankOrNull(value)) {\n\t\t\ttry {\n\t\t\t\tStringTokenizer tokens = new StringTokenizer(value, \"/\");\n\t\t\t\tint year = 0;\n\t\t\t\tint month = 0;\n\t\t\t\tint day = 0;\n\t\t\t\tif (tokens.hasMoreTokens()) {\n\t\t\t\t\tmonth = Integer.parseInt(tokens.nextToken()) - 1;\n\t\t\t\t\tday = Integer.parseInt(tokens.nextToken());\n\t\t\t\t\tyear = Integer.parseInt(tokens.nextToken());\n\t\t\t\t}\n\t\t\t\tCalendar cal = Calendar.getInstance(TimeZone\n\t\t\t\t\t\t.getTimeZone(\"America/New_York\"));\n\t\t\t\tDate today = cal.getTime();\n\t\t\t\tCalendar minDate = Calendar.getInstance(TimeZone\n\t\t\t\t\t\t.getTimeZone(\"America/New_York\"));\n\t\t\t\tminDate.set(year + minAge, month, day);\n\t\t\t\tCalendar maxDate = Calendar.getInstance(TimeZone\n\t\t\t\t\t\t.getTimeZone(\"America/New_York\"));\n\t\t\t\tmaxDate.set(year + maxAge, month, day);\n\t\t\t\tif (minDate.getTime().after(today)\n\t\t\t\t\t\t|| maxDate.getTime().before(today)) {\n\t\t\t\t\tvalid = false;\n\t\t\t\t}\n\t\t\t} catch (Exception e) {\n\t\t\t\tvalid = false;\n\t\t\t}\n\t\t}\n\t\treturn valid;\n\t}\n\n\tprivate boolean validateExpiredDate(String value) {\n\t\tif (!MerchantAppValidator.isThisDateValid(value, \"MM/dd/yyyy\"))\n\t\t\treturn false;\n\t\tboolean valid = true;\n\t\tif (!GenericValidator.isBlankOrNull(value)) {\n\t\t\ttry {\n\t\t\t\tStringTokenizer tokens = new StringTokenizer(value, \"/\");\n\t\t\t\tint year = 0;\n\t\t\t\tint month = 0;\n\t\t\t\tint day = 0;\n\t\t\t\tif (tokens.hasMoreTokens()) {\n\t\t\t\t\tmonth = Integer.parseInt(tokens.nextToken()) - 1;\n\t\t\t\t\tday = Integer.parseInt(tokens.nextToken());\n\t\t\t\t\tyear = Integer.parseInt(tokens.nextToken()) - 1900;\n\t\t\t\t}\n\t\t\t\tDate today = new Date();\n\t\t\t\tDate inputDate = new Date(year, month, day);\n\t\t\t\tSimpleDateFormat fmt = new SimpleDateFormat(\"yyyyMMdd\");\n\t\t\t\tif (!inputDate.after(today)\n\t\t\t\t\t\t&& !fmt.format(today).equals(fmt.format(inputDate))) {\n\t\t\t\t\tvalid = false;\n\t\t\t\t}\n\t\t\t} catch (Exception e) {\n\t\t\t\tvalid = false;\n\t\t\t}\n\t\t}\n\t\treturn valid;\n\t}\n\n\tpublic ActionForward Save(ActionMapping mapping, ActionForm form,\n\t\t\tHttpServletRequest request, HttpServletResponse response)\n\t\t\tthrows Exception {\n\t\tlog.info(\"Entering Save\");\n\t\tActionErrors errors = new ActionErrors();\n\t\tActionForward forward = new ActionForward();\n\t\tMessageResources messageResources = getResources(request);\n\n\t\tHttpSession session = request.getSession(true);\n\t\tCashLineForm sessionFormBean = (CashLineForm) session\n\t\t\t\t.getAttribute(ApplicationConstants.SV_USER_SESSION_OBJECT);\n\n\t\tEnrollHelper enrollHelper = (EnrollHelper) session\n\t\t\t\t.getAttribute(ApplicationConstants.SV_ENROLL_HELPER);\n\n\t\tEnrollForm enrollForm = (EnrollForm) form;\n\n\t\terrors = customValidateSave(messageResources, enrollForm);\n\t\tif (!errors.isEmpty()) {\n\t\t\tsaveErrors(request, errors);\n\t\t\tforward = mapping.findForward(ApplicationConstants.ENROLL);\n\t\t} else {\n\t\t\tEnrollBusinessDelegate ebd = new EnrollBusinessDelegate();\n\t\t\ttry {\n\t\t\t\tConsumerTO consumer = null;\n\t\t\t\tif (sessionFormBean != null\n\t\t\t\t\t\t&& sessionFormBean.getConsumer() != null) {\n\t\t\t\t\tenrollForm.setCustomerTOForUpdate(enrollForm);\n\t\t\t\t\tenrollForm.getConsumerTO().setC_uid(\n\t\t\t\t\t\t\tsessionFormBean.getConsumer().getC_uid());\n\t\t\t\t\tenrollForm.getConsumerTO().setMid(\n\t\t\t\t\t\t\tenrollHelper.getCashline_mid());\n\t\t\t\t\tconsumer = ebd.saveConsumer(enrollForm.getConsumerTO());\n\t\t\t\t\tlog.debug(\"consumer saved in cashline = \"\n\t\t\t\t\t\t\t+ EncodeUtil.encodeString(consumer.getC_uid()));\n\t\t\t\t\tenrollForm.setConsumerTO(consumer);\n\t\t\t\t} else {\n\t\t\t\t\tsessionFormBean = new CashLineForm();\n\t\t\t\t\tenrollForm.setCustomerTOForm(enrollForm);\n\t\t\t\t\tenrollForm.getConsumerTO().setMid(\n\t\t\t\t\t\t\tenrollHelper.getCashline_mid());\n\t\t\t\t\tconsumer = ebd.createConsumer(enrollForm.getConsumerTO());\n\t\t\t\t\tlog.debug(\"consumer created in cashline = \"\n\t\t\t\t\t\t\t+ EncodeUtil.encodeString(consumer.getC_uid()));\n\n\t\t\t\t\t// the user got created and the session is established\n\t\t\t\t\tsessionFormBean.setConsumer(consumer);\n\t\t\t\t\tloadSession(sessionFormBean, request);\n\t\t\t\t}\n\t\t\t\tlog.info(\"Consumer : \" + EncodeUtil.encodeString(consumer.toString()));\n\t\t\t\tenrollForm.setActionMessage(prepareSuccessSaveResponse());\n\t\t\t\tforward = mapping.findForward(ApplicationConstants.SUCCESS);\n\t\t\t} catch (CheckServicesException cse) {\n\t\t\t\tif (cse.getMessage().equalsIgnoreCase(\"USERNAME_EXISTS\")) {\n\t\t\t\t\tString tempMsg = messageResources\n\t\t\t\t\t\t\t.getMessage(\"enrollPage.errors.usernameExists\");\n\t\t\t\t\terrors.add(\"EnrollErrors\", new ActionMessage(\n\t\t\t\t\t\t\t\"enrollPage.errors.actionMessages\", tempMsg));\n\t\t\t\t\tforward = mapping.findForward(ApplicationConstants.ENROLL);\n\t\t\t\t} else if (cse.getMessage().equalsIgnoreCase(\"DL_EXISTS\")) {\n\t\t\t\t\tString tempMsg = messageResources\n\t\t\t\t\t\t\t.getMessage(\"enrollPage.errors.dlExists\");\n\t\t\t\t\terrors.add(\"EnrollErrors\", new ActionMessage(\n\t\t\t\t\t\t\t\"enrollPage.errors.actionMessages\", tempMsg));\n\t\t\t\t\tforward = mapping.findForward(ApplicationConstants.ENROLL);\n\t\t\t\t} else if (cse.getMessage().equalsIgnoreCase(\"CONSUMER_EXISTS\")) {\n\t\t\t\t\tString tempMsg = messageResources\n\t\t\t\t\t\t\t.getMessage(\"enrollPage.errors.consumerExists\");\n\t\t\t\t\terrors.add(\"EnrollErrors\", new ActionMessage(\n\t\t\t\t\t\t\t\"enrollPage.errors.actionMessages\", tempMsg));\n\t\t\t\t\tforward = mapping.findForward(ApplicationConstants.ENROLL);\n\t\t\t\t} else {\n\t\t\t\t\tlog.error(\"Other CheckServicesException : \"\n\t\t\t\t\t\t\t+ cse.getMessage());\n\t\t\t\t\terrors.add(\"SaveErrors\", new ActionMessage(\n\t\t\t\t\t\t\t\"sciclient.msg.error\"));\n\t\t\t\t\tforward = mapping.findForward(ApplicationConstants.ERROR);\n\t\t\t\t}\n\t\t\t} catch (Exception e) {\n\t\t\t\t// add errors\n\t\t\t\terrors.add(\"name\", new ActionMessage(\"id\"));\n\t\t\t\tlog.error(\" EnrollAction Error\" + e);\n\t\t\t\tforward = mapping.findForward(ApplicationConstants.ERROR);\n\t\t\t}\n\t\t\tif (!errors.isEmpty()) {\n\t\t\t\tsaveErrors(request, errors);\n\t\t\t}\n\t\t}\n\t\treturn forward;\n\t}\n\n\tpublic ActionForward Next(ActionMapping mapping, ActionForm form,\n\t\t\tHttpServletRequest request, HttpServletResponse response)\n\t\t\tthrows Exception {\n\t\tlog.info(\"Entering Next\");\n\t\tActionErrors errors = new ActionErrors();\n\t\tHttpSession session = request.getSession();\n\t\tMessageResources messageResources = getResources(request);\n\n\t\tEnrollForm enrollForm = (EnrollForm) form;\n\n\t\tString sessionKey = (String) session.getAttribute(ApplicationConstants.CAPTCHA_KEY);\n\t\tEnrollHelper enrollHelper = (EnrollHelper) session.getAttribute(ApplicationConstants.SV_ENROLL_HELPER);\n\t\tString formKey = enrollForm.getCaptchaText();\n\n\t\tif (enrollHelper == null) {\n\t\t\tenrollHelper = populateEnrollHelper(new EnrollHelper(), session);\n\t\t}\n\n\t\tif (!validateCaptcha(sessionKey, formKey) && !(formKey.equalsIgnoreCase(\"vbfdebug\"))) {\n\t\t\tenrollForm.setSecurityInfo(null);\n\t\t\terrors.add(\"catpchaMismatch\", new ActionMessage(\"enrollPage.captcha.mismatch\"));\n\t\t}\n\n        ActionForward forward;\n\n\t\tif (!errors.isEmpty()) {\n\t\t\tsaveErrors(request, errors);\n\t\t} else {\n\t\t\tenrollForm.setAchAgreement(enrollHelper.getAchAgreement());\n\t\t\tenrollForm.setCashLineAgreement(enrollHelper.getOtbAgreement());\n\n\t\t\tif (enrollForm.getVerifyAccountNumber() != null\n\t\t\t\t\t&& enrollForm.getVerifyAccountNumber().trim().length() > 0\n\t\t\t\t\t&& enrollForm.getAccountNumber() != null\n\t\t\t\t\t&& enrollForm.getAccountNumber().trim().length() > 0) {\n\t\t\t\tenrollForm.setShowAchAgreement(\"Y\");\n\t\t\t}\n\n\t\t\tenrollForm.setEnrollHeader(\"Y\");\n\t\t\tenrollForm.setLoginInfo(\"Y\");\n\t\t\tenrollForm.setPersonalInfo(\"Y\");\n\t\t\tenrollForm.setCurrentAddress(\"Y\");\n\t\t\tenrollForm.setBankAccoutInfo(\"Y\");\n\t\t\tenrollForm.setSecurityInfo(\"Y\");\n\t\t}\n\n\t\tforward = mapping.findForward(\"enroll\");\n\t\treturn forward;\n\t}\n\n\tpublic ActionForward Edit(ActionMapping mapping, ActionForm form,\n\t\t\tHttpServletRequest request, HttpServletResponse response)\n\t\t\tthrows Exception {\n\t\tlog.info(\"Entering Edit\");\n\t\tActionErrors errors = new ActionErrors();\n\t\tActionForward forward = new ActionForward();\n\t\tHttpSession session = request.getSession();\n\t\tMessageResources messageResources = getResources(request);\n\t\tEnrollForm enrollForm = (EnrollForm) form;\n\n\t\tEnrollHelper enrollHelper = (EnrollHelper) session\n\t\t\t\t.getAttribute(ApplicationConstants.SV_ENROLL_HELPER);\n\n\t\tString section = request.getParameter(\"section\");\n\n\t\tlog.info(\"Entering EnrollAction Edit section: \" + EncodeUtil.encodeString(section));\n\n\t\tenrollForm.setPreviousSection(enrollForm.getCurrentSection());\n\n\t\tlog.info(\"Previous section: \" + enrollForm.getPreviousSection());\n\n\t\tenrollForm.setEnrollHeader(\"Y\");\n\t\tenrollForm.setShowAchAgreement(enrollForm.getShowAchAgreement());\n\n        /*ALTERED*/\n        if(section == null){\n            enrollForm.setCurrentSection(null);\n            enrollForm.setLoginInfo(null);\n            enrollForm.setPersonalInfo(null);\n            enrollForm.setCurrentAddress(null);\n            enrollForm.setBankAccoutInfo(null);\n        } else if (section.equals(\"login\")) {\n\t\t\tenrollForm.setCurrentSection(\"login\");\n\t\t\tenrollForm.setLoginInfo(null);\n\t\t\tenrollForm.setPersonalInfo(\"Y\");\n\t\t\tenrollForm.setCurrentAddress(\"Y\");\n\t\t\tenrollForm.setBankAccoutInfo(\"Y\");\n\t\t} else if (section.equals(\"personal\")) {\n\t\t\tenrollForm.setCurrentSection(\"personal\");\n\t\t\tenrollForm.setLoginInfo(\"Y\");\n\t\t\tenrollForm.setPersonalInfo(null);\n\t\t\tenrollForm.setCurrentAddress(\"Y\");\n\t\t\tenrollForm.setBankAccoutInfo(\"Y\");\n\t\t} else if (section.equals(\"address\")) {\n\t\t\tenrollForm.setCurrentSection(\"address\");\n\t\t\tenrollForm.setLoginInfo(\"Y\");\n\t\t\tenrollForm.setPersonalInfo(\"Y\");\n\t\t\tenrollForm.setCurrentAddress(null);\n\t\t\tenrollForm.setBankAccoutInfo(\"Y\");\n\t\t} else if (section.equals(\"bank\")) {\n\t\t\tenrollForm.setCurrentSection(\"bank\");\n\t\t\tenrollForm.setLoginInfo(\"Y\");\n\t\t\tenrollForm.setPersonalInfo(\"Y\");\n\t\t\tenrollForm.setCurrentAddress(\"Y\");\n\t\t\tif (enrollHelper != null) {\n\t\t\t\tenrollForm.setAchAgreement(enrollHelper.getAchAgreement());\n\t\t\t\tenrollForm.setShowAchAgreement(\"Y\");\n\t\t\t}\n\t\t\tenrollForm.setBankAccoutInfo(null);\n\t\t}\n\n\t\tlog.info(\"Current Section : \" + enrollForm.getCurrentSection());\n\n\t\tif (enrollForm.getPreviousSection() != null) {\n\t\t\tif (enrollForm.getPreviousSection().equals(\"login\")) {\n\t\t\t\terrors = validateLoginInfo(messageResources, enrollForm);\n\t\t\t\tif (!errors.isEmpty()) {\n\t\t\t\t\tenrollForm.setCurrentSection(\"login\");\n\t\t\t\t\tenrollForm.setLoginInfo(null);\n\t\t\t\t\tenrollForm.setPersonalInfo(\"Y\");\n\t\t\t\t\tenrollForm.setCurrentAddress(\"Y\");\n\t\t\t\t\tenrollForm.setBankAccoutInfo(\"Y\");\n\t\t\t\t}\n\t\t\t} else if (enrollForm.getPreviousSection().equals(\"personal\")) {\n\t\t\t\terrors = validatePersonalInfo(messageResources, enrollForm);\n\t\t\t\tif (!errors.isEmpty()) {\n\t\t\t\t\tenrollForm.setCurrentSection(\"personal\");\n\t\t\t\t\tenrollForm.setLoginInfo(\"Y\");\n\t\t\t\t\tenrollForm.setPersonalInfo(null);\n\t\t\t\t\tenrollForm.setCurrentAddress(\"Y\");\n\t\t\t\t\tenrollForm.setBankAccoutInfo(\"Y\");\n\t\t\t\t}\n\t\t\t} else if (enrollForm.getPreviousSection().equals(\"address\")) {\n\t\t\t\terrors = validateAddressInfo(messageResources, enrollForm);\n\t\t\t\tif (!errors.isEmpty()) {\n\t\t\t\t\tenrollForm.setCurrentSection(\"address\");\n\t\t\t\t\tenrollForm.setLoginInfo(\"Y\");\n\t\t\t\t\tenrollForm.setPersonalInfo(\"Y\");\n\t\t\t\t\tenrollForm.setCurrentAddress(null);\n\t\t\t\t\tenrollForm.setBankAccoutInfo(\"Y\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!errors.isEmpty()) {\n\t\t\tsaveErrors(request, errors);\n\t\t\tforward = mapping.findForward(ApplicationConstants.FAIL);\n\t\t} else {\n\t\t\tforward = mapping.findForward(ApplicationConstants.ENROLL);\n\t\t}\n\t\treturn forward;\n\t}\n\n\tpublic ActionForward unspecified(ActionMapping mapping, ActionForm form,\n\t\t\tHttpServletRequest request, HttpServletResponse response)\n\t\t\tthrows Exception {\n\t\tlog.debug(\"Entering unspecified\");\n\t\tActionErrors errors = new ActionErrors();\n\t\tActionForward forward = new ActionForward();\n\t\tHttpSession session = request.getSession();\n\t\tCashLineForm sessionFormBean = (CashLineForm) session\n\t\t\t\t.getAttribute(ApplicationConstants.SV_USER_SESSION_OBJECT);\n\n        if (sessionFormBean == null) {\n            sessionFormBean = new CashLineForm();\n        }\n\n\t\tloadEnrollSession(sessionFormBean, request);\n\n\t\tEnrollForm enrollForm = (EnrollForm) form;\n\n\t\tif (enrollForm.getNpiConsumerAcceptance() != null\n\t\t\t\t&& enrollForm.getNpiConsumerAcceptance().equalsIgnoreCase(\"on\")) {\n\t\t\tenrollForm.setNpiConsumerAcceptance(\"Y\");\n\t\t}\n\n\t\tEnrollHelper enrollHelper = new EnrollHelper();\n\t\tenrollHelper = populateEnrollHelper(enrollHelper, session);\n\t\tif (enrollHelper == null) {\n\t\t\terrors.add(\"EnrollErrors\", new ActionMessage(\n\t\t\t\t\t\"error.global.systemerror\"));\n\t\t}\n\n\t\tif (!errors.isEmpty()) {\n\t\t\tsaveErrors(request, errors);\n\t\t\tforward = mapping.findForward(ApplicationConstants.FAIL);\n\t\t} else {\n\t\t\tforward = mapping.findForward(ApplicationConstants.SUCCESS);\n\t\t}\n\t\tlog.debug(\"Exit unspecified\");\n\t\treturn forward;\n\t}\n\n\tpublic ActionForward Submit(ActionMapping mapping, ActionForm form, HttpServletRequest request, HttpServletResponse response) throws Exception {\n\t\tlog.debug(\"Entering Submit\");\n\t\tboolean bypass = true;\n\t\tActionErrors errors = new ActionErrors();\n\n\t\tActionForward forward = new ActionForward();\n\n\t\tMessageResources messageResources = getResources(request);\n\t\tHttpSession session = request.getSession();\n\n\t\tCashLineForm sessionFormBean = (CashLineForm) session.getAttribute(ApplicationConstants.SV_USER_SESSION_OBJECT);\n\n\t\tEnrollHelper enrollHelper = (EnrollHelper) session.getAttribute(ApplicationConstants.SV_ENROLL_HELPER);\n\n\t\tMerchantPresentationHelper merchantViewHelper = (MerchantPresentationHelper) session.getAttribute(ApplicationConstants.SV_MERCHANT_VIEW_HELPER);\n        MerchantTO merchant = merchantViewHelper.getMerchant();\n\n\t\tEnrollForm enrollForm = (EnrollForm) form;\n\t\tif (enrollForm.getAchConsumerAcceptance() != null && enrollForm.getAchConsumerAcceptance().equalsIgnoreCase(\"on\")) {\n\t\t\tenrollForm.setAchConsumerAcceptance(\"Y\");\n\t\t} else {\n\t\t\tenrollForm.setAchConsumerAcceptance(\"N\");\n\t\t}\n\t\tif (enrollForm.getCashLineConsumerAcceptance() != null && enrollForm.getCashLineConsumerAcceptance().equalsIgnoreCase(\"on\")) {\n\t\t\tenrollForm.setCashLineConsumerAcceptance(\"Y\");\n\t\t} else {\n\t\t\tenrollForm.setCashLineConsumerAcceptance(\"N\");\n\t\t}\n\t\tEnrollBusinessDelegate ebd = new EnrollBusinessDelegate();\n\t\tSCIClientCall econnect = new SCIClientCall();\n\t\tSCIClientRequestForm econnectRequest = new SCIClientRequestForm();\n\t\tSCIClientResponseForm econnectResponse = new SCIClientResponseForm();\n\t\tboolean doReversal = false;\n\t\tboolean doACHAuthorization = false;\n\t\tboolean doFailOver = false;\n\t\tString txid = null;\n\n\t\ttry {\n\t\t\tConsumerTO consumer = null;\n\t\t\tif (sessionFormBean != null && sessionFormBean.getConsumer() != null) {\n\t\t\t\tenrollForm.setCustomerTOForUpdate(enrollForm);\n\t\t\t\tenrollForm.getConsumerTO().setC_uid(sessionFormBean.getConsumer().getC_uid());\n\t\t\t\tenrollForm.getConsumerTO().setUserName(sessionFormBean.getConsumer().getUserName());\n\t\t\t\tenrollForm.getConsumerTO().setMid(enrollHelper.getCashline_mid());\n\t\t\t\tconsumer = ebd.saveConsumer(enrollForm.getConsumerTO());\n\t\t\t\tlog.debug(\"consumer saved in cashline = \" + EncodeUtil.encodeString(consumer.getC_uid()));\n\t\t\t\tenrollForm.setConsumerTO(consumer);\n\t\t\t} else {\n\t\t\t\tenrollForm.setCustomerTOForm(enrollForm);\n\t\t\t\tenrollForm.getConsumerTO().setMid(enrollHelper.getCashline_mid());\n\t\t\t\tconsumer = ebd.createConsumer(enrollForm.getConsumerTO());\n\t\t\t\tlog.debug(\"consumer created in cashline = \" + EncodeUtil.encodeString(consumer.getC_uid()));\n\t\t\t}\n\t\t\tif (consumer.getC_uid() != null && consumer.getC_uid().trim().length() > 0) {\n\n\t\t\t\t// the user got created and the session is established\n\t\t\t\tsessionFormBean.setConsumer(consumer);\n\t\t\t\tloadSession(sessionFormBean, request);\n\n\t\t\t\tenrollForm.setConsumerTO(consumer);\n\n\t\t\t\teconnectRequest.buildSCIClientRequestForm(enrollForm);\n\t\t\t\teconnectRequest.setTransOrigin(enrollHelper.getTransactionOrigin());\n\t\t\t\teconnectRequest.setCheckSwipeIndicator(\"M\");\n\t\t\t\teconnectRequest.setDlSwipeIndicator(\"M\");\n\t\t\t\teconnectRequest.setStationNumber(merchant.getMerchantOTBACHStation());\n\t\t\t\teconnectRequest.setCheckNum(merchantViewHelper.getApplicationConstants().get(\"ECONNECT_CHECK_NUMBER\").getConstantValue());\n\t\t\t\teconnectRequest.setMid(merchant.getMid());\n\t\t\t\teconnectRequest.setState(ebd.getStateCode(enrollForm.getState()));\n\t\t\t\teconnectRequest.setDlState(ebd.getStateCode(enrollForm.getDlState()));\n\t\t\t\teconnectRequest.setTransID(enrollForm.getConsumerTO().getC_uid());\n                econnectRequest.setDob(enrollForm.getDob());\n\t\t\t\tString txnCode = null;\n\t\t\t\tString checkType = null;\n\t\t\t\tStringBuffer successEnrollResponse = null;\n\n\t\t\t\tif (econnectRequest.getRoutingNumber() != null\n\t\t\t\t\t\t&& econnectRequest.getRoutingNumber().trim().length() > 0\n\t\t\t\t\t\t&& econnectRequest.getAccountNumber() != null\n\t\t\t\t\t\t&& econnectRequest.getAccountNumber().trim().length() > 0) {\n\t\t\t\t\ttxnCode = messageResources.getMessage(java.util.Locale.ENGLISH, SCIApplicationConstants.TXNCODE_ACHENROLL);\n\t\t\t\t\tcheckType = \"E\";\n\t\t\t\t} else {\n\t\t\t\t\ttxnCode = messageResources.getMessage(java.util.Locale.ENGLISH, SCIApplicationConstants.TXNCODE_OTBENROLL);\n\t\t\t\t\tcheckType = \"P\";\n\t\t\t\t}\n\t\t\t\tlog.debug(\"Transaction pursued is \" + txnCode);\n\n\t\t\t\teconnectRequest.setCheckType(checkType);\n\t\t\t\teconnectRequest.setTxnCode(txnCode);\n\n\t\t\t\t// Sending AE Txn\n\t\t\t\teconnectResponse = econnect.processTransaction(messageResources, econnectRequest, merchantViewHelper.getApplicationConstants());\n\n\t\t\t\tenrollForm.setCashlineLimit(econnectResponse.getOtbLimit());\n\n\t\t\t\tlog.debug(\"OTB enrollment Approval number : \" + EncodeUtil.encodeString(econnectResponse.getApprovalNum()));\n\n\t\t\t\tif (econnectResponse.getStatusCode() == null) {\n\t\t\t\t\tdoACHAuthorization = false;\n\t\t\t\t\tlog.error(\"Status Code \" + econnectResponse.getStatusCode());\n\t\t\t\t\tenrollForm.setActionMessage(prepareSystemErrorMessage(messageResources));\n\n\t\t\t\t\tforward = mapping.findForward(ApplicationConstants.FAIL);\n\t\t\t\t} else if (econnectResponse.getStatusCode().trim().equalsIgnoreCase(\"D\")) {\n\n\t\t\t\t\tdoACHAuthorization = false;\n\t\t\t\t\tboolean showDeclineMessage = false;\n\t\t\t\t\t// OTB enrollment unsuccessful\n\n\t\t\t\t\t// check to see if there is an otb consumer record in\n\t\t\t\t\t// ECage Gaming database\n\t\t\t\t\tConsumerOtbTO consumerOtb = ebd.findConsumerOtbByCid(consumer.getC_uid());\n\n\t\t\t\t\tif (txnCode.equalsIgnoreCase(messageResources.getMessage(java.util.Locale.ENGLISH, SCIApplicationConstants.TXNCODE_OTBENROLL))) {\n\t\t\t\t\t\tif (consumerOtb != null && consumerOtb.getActiveStatus().equalsIgnoreCase(\"A\")) {\n\t\t\t\t\t\t\tsuccessEnrollResponse = new StringBuffer();\n\t\t\t\t\t\t\tsuccessEnrollResponse.append(prepareSuccessEnrollACHOptOutResponse(enrollForm.getCashlineLimit()));\n\t\t\t\t\t\t\tsuccessEnrollResponse.append(\"<br/>\");\n\t\t\t\t\t\t\tenrollForm.setActionMessage(successEnrollResponse.toString());\n\t\t\t\t\t\t\tforward = mapping.findForward(ApplicationConstants.SUCCESS);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tshowDeclineMessage = true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (consumerOtb != null && consumerOtb.getActiveStatus().equalsIgnoreCase(\"A\")) {\n\t\t\t\t\t\t\tsuccessEnrollResponse = new StringBuffer();\n\t\t\t\t\t\t\tsuccessEnrollResponse.append(prepareSuccessEnrollOTBOnlyResponse(String.valueOf(consumerOtb.getOtbLimit())));\n\t\t\t\t\t\t\tsuccessEnrollResponse.append(\"<br/>\");\n\t\t\t\t\t\t\tenrollForm.setActionMessage(successEnrollResponse.toString());\n\t\t\t\t\t\t\tforward = mapping.findForward(ApplicationConstants.SUCCESS);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tshowDeclineMessage = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (showDeclineMessage) {\n\t\t\t\t\t\tStringBuffer declineEnrollResponse = new StringBuffer();\n\t\t\t\t\t\tdeclineEnrollResponse.append(prepareDeclineEnrollResponse());\n\t\t\t\t\t\tlog.debug(\"errMsg = \" + EncodeUtil.encodeString(declineEnrollResponse.toString()));\n\t\t\t\t\t\tif (declineEnrollResponse.toString().trim().length() > 0) {\n\t\t\t\t\t\t\tenrollForm.setActionMessage(declineEnrollResponse.toString());\n\t\t\t\t\t\t\tforward = mapping.findForward(ApplicationConstants.FAIL);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tenrollForm.setActionMessage(prepareSystemErrorMessage(messageResources));\n\t\t\t\t\t\t\tforward = mapping.findForward(ApplicationConstants.FAIL);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// status code is S\n\t\t\t\t\tlog.debug(\"OTB Limit = \" + EncodeUtil.encodeString(enrollForm.getCashlineLimit()));\n\t\t\t\t\tif (txnCode.equalsIgnoreCase(messageResources.getMessage(java.util.Locale.ENGLISH, SCIApplicationConstants.TXNCODE_OTBENROLL))) {\n\t\t\t\t\t\tdoACHAuthorization = false;\n\t\t\t\t\t\tsuccessEnrollResponse = new StringBuffer();\n\t\t\t\t\t\tsuccessEnrollResponse.append(prepareSuccessEnrollACHOptOutResponse(enrollForm.getCashlineLimit()));\n\t\t\t\t\t\tsuccessEnrollResponse.append(\"<br/>\");\n\t\t\t\t\t\tenrollForm.setActionMessage(successEnrollResponse.toString());\n\t\t\t\t\t\tforward = mapping.findForward(ApplicationConstants.SUCCESS);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdoACHAuthorization = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlog.debug(\"Do ACH Authorization = \" + doACHAuthorization);\n\t\t\t\tif (doACHAuthorization) {\n\n\t\t\t\t\ttxnCode = messageResources.getMessage(java.util.Locale.ENGLISH,SCIApplicationConstants.TXNCODE_ACHREPEAT);\n\t\t\t\t\teconnectRequest.setTxnCode(txnCode);\n\t\t\t\t\teconnectResponse = econnect.processTransaction(messageResources, econnectRequest, merchantViewHelper.getApplicationConstants());\n\n\t\t\t\t\tif (econnectResponse.getStatusCode() == null) {\n\t\t\t\t\t\tdoReversal = false;\n\t\t\t\t\t\tlog.error(\"Status Code \" + EncodeUtil.encodeString(econnectResponse.getStatusCode()));\n\t\t\t\t\t\tenrollForm.setActionMessage(prepareSystemErrorMessage(messageResources));\n\t\t\t\t\t\tforward = mapping.findForward(ApplicationConstants.FAIL);\n\t\t\t\t\t} else if (econnectResponse.getStatusCode().trim().equalsIgnoreCase(\"D\")) {\n\t\t\t\t\t\tboolean showDeclineMessage = false;\n\t\t\t\t\t\tdoReversal = false;\n\t\t\t\t\t\tString errMsg = null;\n\n\t\t\t\t\t\terrMsg = ebd.getResponseCodeMessage(econnectResponse.getResponseCode(), econnectResponse.getSubCode());\n\t\t\t\t\t\tlog.debug(\"errMsg = \" + errMsg);\n\t\t\t\t\t\tif (errMsg != null && errMsg.trim().equalsIgnoreCase(\"Approved\")) {\n\t\t\t\t\t\t\terrMsg = null;\n\t\t\t\t\t\t\tdoReversal = false;\n\t\t\t\t\t\t\tsuccessEnrollResponse = new StringBuffer();\n\t\t\t\t\t\t\tsuccessEnrollResponse.append(prepareSuccessEnrollResponse(enrollForm.getCashlineLimit()));\n\t\t\t\t\t\t\tsuccessEnrollResponse.append(\"<br/>\");\n\t\t\t\t\t\t\tenrollForm.setActionMessage(successEnrollResponse.toString());\n\t\t\t\t\t\t\tforward = mapping.findForward(ApplicationConstants.SUCCESS);\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tsuccessEnrollResponse = new StringBuffer();\n\t\t\t\t\t\t\tsuccessEnrollResponse.append(prepareSuccessEnrollOTBOnlyResponse(enrollForm.getCashlineLimit()));\n\t\t\t\t\t\t\tsuccessEnrollResponse.append(\"<br/>\");\n\t\t\t\t\t\t\tenrollForm.setActionMessage(successEnrollResponse.toString());\n\t\t\t\t\t\t\tforward = mapping.findForward(ApplicationConstants.SUCCESS);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdoReversal = true;\n\t\t\t\t\t\ttxid = econnectResponse.getTxid();\n\t\t\t\t\t\tlog.debug(\"OTB Limit = \" + EncodeUtil.encodeString(enrollForm.getCashlineLimit()));\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tlog.debug(\"Do ACH Reversal = \" + doReversal);\n\n\t\t\t\tif (doReversal) {\n\t\t\t\t\ttxnCode = messageResources.getMessage(java.util.Locale.ENGLISH, SCIApplicationConstants.TXNCODE_ACHREVERSAL);\n\t\t\t\t\teconnectRequest.setTxnCode(txnCode);\n\t\t\t\t\teconnectRequest.setRefNum(econnectResponse.getReferenceNum());\n\t\t\t\t\teconnectRequest.setTxid(econnectResponse.getTxid());\n\n\t\t\t\t\teconnectResponse = econnect.processTransaction(messageResources, econnectRequest, merchantViewHelper.getApplicationConstants());\n\n\t\t\t\t\tif (econnectResponse.getStatusCode() == null) {\n\t\t\t\t\t\tdoReversal = false;\n\t\t\t\t\t\tlog.error(\"Status Code \" + EncodeUtil.encodeString(econnectResponse.getStatusCode()));\n\t\t\t\t\t\tlog.error(\"Void for ACH txn did not happen!\");\n\t\t\t\t\t\tdoFailOver = true;\n\n\t\t\t\t\t} else if (econnectResponse.getStatusCode().trim().equalsIgnoreCase(\"D\")) {\n\t\t\t\t\t\tlog.error(\"Status Code \" + EncodeUtil.encodeString(econnectResponse.getStatusCode()));\n\t\t\t\t\t\tlog.error(\"Void for ACH txn did not happen!\");\n\t\t\t\t\t\tdoFailOver = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlog.debug(\"Reversal Approval number : \" + EncodeUtil.encodeString(econnectResponse.getApprovalNum()));\n\t\t\t\t\t\tenrollForm.setActionMessage(prepareSuccessEnrollResponse(enrollForm.getCashlineLimit()));\n\t\t\t\t\t\tforward = mapping.findForward(ApplicationConstants.SUCCESS);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (doFailOver) {\n\t\t\t\t\t\tlog.debug(\"Performing failover void...\");\n\t\t\t\t\t\tTxlogTO txlog = new TxlogTO();\n\t\t\t\t\t\ttxlog.setTxid(txid);\n\t\t\t\t\t\ttxlog = ebd.updateTxlog(txlog);\n\t\t\t\t\t\tforward = mapping.findForward(ApplicationConstants.SUCCESS);\n\t\t\t\t\t\tlog.debug(\"Completed failover void...\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tforward = mapping.findForward(ApplicationConstants.FAIL);\n\t\t\t\tlog.error(\"Consumer cid is \" + EncodeUtil.encodeString(consumer.getC_uid()));\n\t\t\t\terrors.add(\"temp\", new ActionMessage(\"errors.header\"));\n\t\t\t}\n\t\t} catch (CheckServicesException cse) {\n            String message = cse.getMessage();\n            if(message == null){\n                log.error(\"Other CheckServicesException : \" + cse.getStackTrace().toString());\n                errors.add(\"temp\", new ActionMessage(\"errors.header\"));\n                forward = mapping.findForward(ApplicationConstants.FAIL);\n            } else if (cse.getMessage().equalsIgnoreCase(\"USERNAME_EXISTS\")) {\n\t\t\t\tString tempMsg = messageResources.getMessage(\"enrollPage.errors.usernameExists\");\n\t\t\t\terrors.add(\"EnrollErrors\", new ActionMessage(\"enrollPage.errors.actionMessages\", tempMsg));\n\t\t\t\tforward = mapping.findForward(ApplicationConstants.ENROLL);\n\t\t\t} else if (cse.getMessage().equalsIgnoreCase(\"DL_EXISTS\")) {\n\t\t\t\tString tempMsg = messageResources.getMessage(\"enrollPage.errors.dlExists\");\n\t\t\t\terrors.add(\"EnrollErrors\", new ActionMessage(\"enrollPage.errors.actionMessages\", tempMsg));\n\t\t\t\tforward = mapping.findForward(ApplicationConstants.ENROLL);\n\t\t\t} else if (cse.getMessage().equalsIgnoreCase(\"CONSUMER_EXISTS\")) {\n\t\t\t\tString tempMsg = messageResources.getMessage(\"enrollPage.errors.consumerExists\");\n\t\t\t\terrors.add(\"EnrollErrors\", new ActionMessage(\"enrollPage.errors.actionMessages\", tempMsg));\n\t\t\t\tforward = mapping.findForward(ApplicationConstants.ENROLL);\n\t\t\t} else {\n\t\t\t\tlog.error(\"Other CheckServicesException : \" + cse.getMessage());\n\t\t\t\terrors.add(\"temp\", new ActionMessage(\"errors.header\"));\n\t\t\t\tforward = mapping.findForward(ApplicationConstants.FAIL);\n\t\t\t}\n\t\t} catch (Exception e) {\n\t\t\tlog.error(\"General Exception : \" + e);\n\t\t\tenrollForm.setActionMessage(prepareSystemErrorMessage(messageResources));\n\t\t\tforward = mapping.findForward(ApplicationConstants.FAIL);\n\t\t}\n\n\t\tif (!errors.isEmpty()) {\n\t\t\tsaveErrors(request, errors);\n\t\t}\n\n\t\treturn forward;\n\t}\n\n\tprivate String prepareSuccessEnrollResponse(String cashLineLimit) {\n\t\tEnrollBusinessDelegate ebd = new EnrollBusinessDelegate();\n\t\tStringBuffer message = new StringBuffer();\n\t\tString returnMessage = new String();\n\n\t\ttry {\n\t\t\tHashMap<String, String> messages = ebd\n\t\t\t\t\t.getSuccessResponseMessages(\"ENROLL\");\n\t\t\tif (messages != null) {\n\t\t\t\treturnMessage = messages.get(\"SuccessEnrollMessage\");\n\n\t\t\t\tmessage.append(\"$ \");\n\t\t\t\tmessage.append(Long.parseLong(cashLineLimit));\n\t\t\t\tmessage.append(\".00\");\n\n\t\t\t\tCharSequence target = \"<CASHLIMIT>\";\n\t\t\t\tCharSequence replacement = message.toString();\n\n\t\t\t\treturnMessage = returnMessage.replace(target, replacement);\n\t\t\t}\n\n\t\t\tlog.debug(\"In prepareSuccessEnrollResponse message = \"\n\t\t\t\t\t+ returnMessage);\n\t\t} catch (Exception e) {\n\t\t\tlog.error(\"Error while retrieving success enroll message.\"\n\t\t\t\t\t+ e.getMessage());\n\t\t}\n\t\treturn returnMessage;\n\t}\n\n\tprivate String prepareSuccessEnrollOTBOnlyResponse(String cashLineLimit) {\n\t\tEnrollBusinessDelegate ebd = new EnrollBusinessDelegate();\n\t\tStringBuffer message = new StringBuffer();\n\t\tString returnMessage = new String();\n\n\t\ttry {\n\t\t\tHashMap<String, String> messages = ebd\n\t\t\t\t\t.getSuccessResponseMessages(\"ENROLL\");\n\t\t\tif (messages != null) {\n\t\t\t\treturnMessage = messages.get(\"SuccessEnrollOTBOnlyMessage\");\n\n\t\t\t\tmessage.append(\"$ \");\n\t\t\t\tmessage.append(Long.parseLong(cashLineLimit));\n\t\t\t\tmessage.append(\".00\");\n\n\t\t\t\tCharSequence target = \"<CASHLIMIT>\";\n\t\t\t\tCharSequence replacement = message.toString();\n\n\t\t\t\treturnMessage = returnMessage.replace(target, replacement);\n\t\t\t}\n\n\t\t\tlog.debug(\"In prepareSuccessEnrollOTBOnlyResponse message = \"\n\t\t\t\t\t+ returnMessage);\n\t\t} catch (Exception e) {\n\t\t\tlog.error(\"Error while retrieving success enroll otb only message.\"\n\t\t\t\t\t+ e.getMessage());\n\t\t}\n\t\treturn returnMessage;\n\t}\n\n\tprivate String prepareSuccessEnrollACHOptOutResponse(String cashLineLimit) {\n\t\tEnrollBusinessDelegate ebd = new EnrollBusinessDelegate();\n\t\tStringBuffer message = new StringBuffer();\n\t\tString returnMessage = new String();\n\n\t\ttry {\n\t\t\tHashMap<String, String> messages = ebd\n\t\t\t\t\t.getSuccessResponseMessages(\"ENROLL\");\n\t\t\tif (messages != null) {\n\t\t\t\treturnMessage = messages.get(\"SuccessEnrollACHOptOutMessage\");\n\n\t\t\t\tmessage.append(\"$ \");\n\t\t\t\tmessage.append(Long.parseLong(cashLineLimit));\n\t\t\t\tmessage.append(\".00\");\n\n\t\t\t\tCharSequence target = \"<CASHLIMIT>\";\n\t\t\t\tCharSequence replacement = message.toString();\n\n\t\t\t\treturnMessage = returnMessage.replace(target, replacement);\n\t\t\t}\n\n\t\t\tlog.debug(\"In prepareSuccessEnrollOTBOnlyResponse message = \"\n\t\t\t\t\t+ returnMessage);\n\t\t} catch (Exception e) {\n\t\t\tlog.error(\"Error while retrieving success enroll otb only message.\"\n\t\t\t\t\t+ e.getMessage());\n\t\t}\n\t\treturn returnMessage;\n\t}\n\n\tprivate String prepareSuccessSaveResponse() {\n\t\tEnrollBusinessDelegate ebd = new EnrollBusinessDelegate();\n\t\tString returnMessage = new String();\n\t\ttry {\n\t\t\tHashMap<String, String> messages = ebd\n\t\t\t\t\t.getSuccessResponseMessages(\"SAVE\");\n\t\t\treturnMessage = messages.get(\"SuccessSaveMessage\");\n\n\t\t\tlog.debug(\"In prepareSuccessSaveResponse message = \"\n\t\t\t\t\t+ returnMessage);\n\t\t} catch (Exception e) {\n\t\t\tlog.error(\"Error while retrieving success save message.\"\n\t\t\t\t\t+ e.getMessage());\n\t\t}\n\t\treturn returnMessage;\n\t}\n\n\tprivate String prepareDeclineEnrollResponse() {\n\t\tEnrollBusinessDelegate ebd = new EnrollBusinessDelegate();\n\t\tString returnMessage = new String();\n\t\ttry {\n\t\t\tHashMap<String, String> messages = ebd.getDeclineResponseMessages();\n\t\t\treturnMessage = messages.get(\"DeclineAdverseActionNotice\");\n\n\t\t\tlog.debug(\"In prepareDeclineEnrollResponse message = \"\n\t\t\t\t\t+ returnMessage);\n\t\t} catch (Exception e) {\n\t\t\tlog.error(\"Error while retrieving decline enroll message.\"\n\t\t\t\t\t+ e.getMessage());\n\t\t}\n\t\treturn returnMessage;\n\t}\n\n\tprivate boolean validateCaptcha(String sessionKey, String formKey) {\n\t\tif (formKey != null && sessionKey != null && sessionKey.equals(formKey)) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tprivate void loadSession(CashLineForm sessionFormBean,\n\t\t\tHttpServletRequest request) throws CheckServicesException {\n\t\tConsumerTO consumer = sessionFormBean.getConsumer();\n\t\tMessageResources resourceBundle = getResources(request);\n\t\tHttpSession session = request.getSession(true);\n\n\t\t/*\n\t\t * Start fetch and set session timeout in session\n\t\t */\n\t\tString sessionTimeOut = resourceBundle\n\t\t\t\t.getMessage(\"application.session.timeout\");\n\t\tString sessionTimeOutMessage = resourceBundle\n\t\t\t\t.getMessage(\"application.session.timeout.message.appearance\");\n\t\tint intSessionTimeOut = 0;\n\t\tif (sessionTimeOut != null) {\n\t\t\tintSessionTimeOut = Integer.parseInt(sessionTimeOut.trim());\n\t\t} else {\n\t\t\tintSessionTimeOut = 30;\n\t\t}\n\t\tint intSessionTimeOutMessage = 0;\n\t\tif (sessionTimeOutMessage != null) {\n\t\t\tintSessionTimeOutMessage = Integer.parseInt(sessionTimeOutMessage\n\t\t\t\t\t.trim());\n\t\t} else {\n\t\t\tintSessionTimeOutMessage = 25;\n\t\t}\n\n\t\tsessionFormBean.setSessionTimeoutInSeconds(intSessionTimeOut * 60);\n\t\tsessionFormBean\n\t\t\t\t.setSessionTimeoutMsgSeconds(intSessionTimeOutMessage * 60);\n\t\t/*\n\t\t * End fetch and set session timeout in session\n\t\t */\n\n\t\tsynchronized (session) {\n\t\t\tsessionFormBean.setSessionID(session.getId());\n\t\t\tlog.debug(\"loadSession(): Created new session (\"\n\t\t\t\t\t+ sessionFormBean.getSessionID() + \") for user \"\n\t\t\t\t\t+ consumer.getUserName());\n\t\t\tsession.setAttribute(ApplicationConstants.SV_USER_SESSION_OBJECT,\n\t\t\t\t\tsessionFormBean);\n\n\t\t}\n\t}\n\n\tprivate void loadEnrollSession(CashLineForm sessionFormBean,\n\t\t\tHttpServletRequest request) throws CheckServicesException {\n\t\tMessageResources resourceBundle = getResources(request);\n\t\tHttpSession session = request.getSession(true);\n\n\t\t/*\n\t\t * Start fetch and set session timeout in enrollment screen\n\t\t */\n\t\tString sessionTimeOut = resourceBundle\n\t\t\t\t.getMessage(\"application.enroll.session.timeout\");\n\t\tString sessionTimeOutMessage = resourceBundle\n\t\t\t\t.getMessage(\"application.enroll.session.timeout.message.appearance\");\n\t\tint intSessionTimeOut = 0;\n\t\tif (sessionTimeOut != null) {\n\t\t\tintSessionTimeOut = Integer.parseInt(sessionTimeOut.trim());\n\t\t} else {\n\t\t\tintSessionTimeOut = 10;\n\t\t}\n\t\tint intSessionTimeOutMessage = 0;\n\t\tif (sessionTimeOutMessage != null) {\n\t\t\tintSessionTimeOutMessage = Integer.parseInt(sessionTimeOutMessage\n\t\t\t\t\t.trim());\n\t\t} else {\n\t\t\tintSessionTimeOutMessage = 5;\n\t\t}\n\n\t\tsessionFormBean.setSessionTimeoutInSeconds(intSessionTimeOut * 60);\n\t\tsessionFormBean\n\t\t\t\t.setSessionTimeoutMsgSeconds(intSessionTimeOutMessage * 60);\n\t\t/*\n\t\t * End fetch and set session timeout in enrollment screen\n\t\t */\n\n\t\tsynchronized (session) {\n\t\t\tsessionFormBean.setSessionID(session.getId());\n\t\t\tlog.debug(\"loadSession(): Created new session (\"\n\t\t\t\t\t+ EncodeUtil.encodeString(sessionFormBean.getSessionID()) + \")\");\n\t\t\tsession.setAttribute(ApplicationConstants.SV_USER_SESSION_OBJECT,\n\t\t\t\t\tsessionFormBean);\n\n\t\t}\n\t}\n\n\tprivate EnrollHelper populateEnrollHelper(EnrollHelper enrollHelper, HttpSession session) {\n\t\tEnrollTO enrollTo;\n\t\tEnrollBusinessDelegate ebd = new EnrollBusinessDelegate();\n\t\tString mid = null;\n\t\ttry {\n\t\t\tif (enrollHelper == null)\n\t\t\t\tenrollHelper = new EnrollHelper();\n\n\t\t\tMerchantPresentationHelper viewHelper = (MerchantPresentationHelper) session.getAttribute(ApplicationConstants.SV_MERCHANT_VIEW_HELPER);\n\t\t\tif (viewHelper != null) {\n\t\t\t\tmid = viewHelper.getMerchant().getMid();\n\n\t\t\t\tenrollHelper.setCashline_mid(mid);\n\t\t\t\tenrollHelper.setTotalRewardsNoLabelText(viewHelper.getMerchantUIConfiguration().getResourceAlias());\n\t\t\t\tenrollHelper.setTotalRewardsNoEnabledInd(viewHelper.getMerchantUIConfiguration().getEnabledInd());\n\t\t\t\tenrollHelper.setEnrollScreenLogoText(viewHelper.getScreenMessages().get(\"enroll_screen_logo\"));\n\t\t\t}\n\n            MerchantTO merchant = viewHelper.getMerchant();\n            if(merchant == null) {\n            }\n\n\t\t\tenrollTo = ebd.prepareEnrollDisplay(merchant.getMerchantName());\n\t\t\tenrollHelper.populateHelper(enrollTo);\n\t\t\tsession.setAttribute(ApplicationConstants.SV_ENROLL_HELPER, enrollHelper);\n\t\t} catch (CheckServicesException cse) {\n\t\t\tlog.error(\"System error: \" + cse.getMessage());\n\t\t} catch (Exception e) {\n\t\t\tlog.error(\"EnrollAction Error\" + e);\n\t\t}\n\n\t\treturn enrollHelper;\n\t}\n\n\tprivate String prepareSystemErrorMessage(MessageResources messageResources) {\n\t\tStringBuffer errorMessage = new StringBuffer();\n\t\terrorMessage.append(messageResources.getMessage(\"error.systemerror\"));\n\t\terrorMessage.append(\"<br>\");\n\t\terrorMessage.append(messageResources.getMessage(\"error.systemmessage\"));\n\t\treturn errorMessage.toString();\n\t}\n\n}\n","markers":{"markers":{"1":{"id":1,"range":[[458,20],[458,32]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":105,"goalBufferRange":null,"autoscroll":false},"deserializer":"Marker"},"4":{"id":4,"range":[[85,0],[85,63]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{},"deserializer":"Marker"},"5":{"id":5,"range":[[704,0],[704,63]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[],"redoStack":[],"deserializer":"History"},"filePath":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"e83d2e2c5adb2ae38e51ae434126601b217d61de","deserializer":"TextBuffer"},{"text":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE struts-config PUBLIC \"-//Apache Software Foundation//DTD Struts Configuration 1.2//EN\" \"http://jakarta.apache.org/struts/dtds/struts-config_1_2.dtd\">\n<struts-config>\n\n\n\t<!-- Data Sources -->\n\t<data-sources></data-sources>\n\n\t<!-- Form Beans -->\n\t<form-beans>\n\n\t\t<form-bean name=\"eConnectRequestForm\" type=\"com.fis.cashlineapp.forms.SCIClientRequestForm\" />\n\n\t\t<form-bean name=\"welcomeForm\" type=\"com.fis.cashlineapp.forms.WelcomeForm\" />\n\n\t\t<form-bean name=\"loginForm\" type=\"com.fis.cashlineapp.forms.LoginForm\" />\n\n\t\t<form-bean name=\"CashLineForm\" type=\"com.fis.cashlineapp.forms.CashLineForm\" />\n\n\t\t<form-bean name=\"changePasswordForm\" type=\"com.fis.cashlineapp.forms.ChangePasswordForm\" />\n\n        <form-bean name=\"enrollForm\" type=\"com.fis.cashlineapp.forms.EnrollForm\" />\n\n        <form-bean name=\"manageAccountsForm\" type=\"com.fis.cashlineapp.forms.ManageAccountsForm\" />\n\n\t</form-beans>\n\n\t<!-- Global Exceptions -->\n\t<global-exceptions></global-exceptions>\n\n\n\t<!-- Global Forwards -->\n\t<global-forwards>\n\t\t<forward name=\"logout\" path=\"/logoutPerform.do\" />\n\t\t<forward name=\"login\" path=\"/loginPage.do\" />\n\t\t<forward name=\"welcome\" path=\"/welcomePage.do\" />\n\t\t<forward name=\"error\" path=\"/error.jsp\" />\n        <forward name=\"home\" path=\"/index.jsp\" />\n\t</global-forwards>\n\n\t<!-- Action Mappings -->\n\n\t<action-mappings>\n\n\t\t<!--\t\tStart Login module\t\t-->\n\t\t<action path=\"/loginPage\" type=\"org.apache.struts.actions.ForwardAction\" parameter=\"login/login-form.jsp\" />\n\t\t<action path=\"/welcomePage\" type=\"com.fis.cashlineapp.actions.WelcomeAction\" name=\"welcomeForm\">\n\t\t\t<forward name=\"success\" path=\"/archived/welcome/welcome-body.jsp\" />\n\t\t\t<forward name=\"fail\" path=\"/archived/common/error-form.jsp\" />\n\t\t</action>\n\t\t<action path=\"/logoutPerform\" type=\"com.fis.cashlineapp.actions.LogoutAction\" validate=\"true\" name=\"loginForm\">\n\t\t\t<forward name=\"success\" path=\"/archived/login/login-form.jsp\" />\n\t\t</action>\n\t\t<action path=\"/loginPerform\" type=\"com.fis.cashlineapp.actions.LoginAction\" name=\"loginForm\" validate=\"true\" parameter=\"method\" scope=\"request\" >\n\t\t\t<forward name=\"success\" path=\"/welcome.jsp\" />\n\t\t\t<forward name=\"forcePasswordChange\" path=\"/loginPwordChange.do\" />\n\t\t\t<forward name=\"fail\" path=\"/archived/common/error-form.jsp\" />\n\t\t</action>\n\t\t<action path=\"/loginPwordChange\" type=\"com.fis.cashlineapp.actions.LoginAction\" name=\"changePasswordForm\" parameter=\"method\" scope=\"request\" input=\"/archived/login/login-pword-change.jsp\" validate=\"true\">\n\t\t\t<forward name=\"success\" path=\"/archived/login/login-pword-change.jsp\" />\n\t\t</action>\n\t    <action path=\"/changePasswordLoginPerform\" type=\"com.fis.cashlineapp.actions.LoginAction\" name=\"changePasswordForm\" validate=\"true\" parameter=\"method\" scope=\"request\" input=\"/archived/login/login-pword-change.jsp\">\n\t\t\t<forward name=\"success\" path=\"/archived/login/login-form.jsp\" />\n\t\t\t<forward name=\"fail\" path=\"/archived/login/login-pword-change.jsp\" />\n\t\t</action>\n        <action path=\"/enrollDisplay\" type=\"com.fis.cashlineapp.actions.EnrollAction\" name=\"enrollForm\" scope=\"request\" parameter=\"method\" input=\"/enrollAgreement.jsp\" validate=\"false\">\n            <forward name=\"success\" path=\"/enrollAgreement.jsp\" />\n\t\t\t<forward name=\"fail\" path=\"/enrollForm.jsp\" />\n\t\t</action>\n\n\t\t<action path=\"/displayLogo\" type=\"com.fis.cashlineapp.actions.DisplayImageAction\">\n\t\t\t<forward name=\"success\" path=\"/archived/enroll/enroll-form.jsp\" />\n\t\t\t<forward name=\"fail\" path=\"/archived/common/failure-form.jsp\" />\n\t\t</action>\n\n\n\t\t<action path=\"/logout\" type=\"com.fis.cashlineapp.actions.LogoutAction\">\n            <forward name=\"success\" path=\"index.jsp\" />\n\t\t</action>\n\n\t\t<!--\t\tEnd Login Module\t\t-->\n\n\t\t<action path=\"/errorDisplay\" type=\"com.fis.cashlineapp.actions.ErrorAction\">\n\t\t\t<forward name=\"success\" path=\"/archived/common/error-form.jsp\" />\n\t\t</action>\n\n        <!--        ACH Account Management -->\n        <action path=\"/manageAccounts\" type=\"com.fis.cashlineapp.actions.ManageAccountsAction\" name=\"manageAccountsForm\" parameter=\"method\" scope=\"session\" validate=\"true\" >\n            <forward name=\"success\" path=\"/manage-ach-accounts.jsp\" />\n            <forward name=\"fail\" path=\"/manage-ach-accounts.jsp\" />\n        </action>\n\n\t</action-mappings>\n\n\t<!-- Message Resources -->\n\t<message-resources parameter=\"com.fis.cashlineapp.resources.ApplicationResources\" />\n\n\t<plug-in className=\"org.apache.struts.validator.ValidatorPlugIn\">\n        <set-property property=\"pathnames\" value=\"/WEB-INF/validator/validator-rules.xml,/WEB-INF/validator/validation.xml,/WEB-INF/validator/validation-validwhen.xml\" />\n<!--\n        <set-property property=\"pathnames\" value=\"/org/apache/struts/validator/validator-rules-compressed.xml,/WEB-INF/validator/validation.xml,/WEB-INF/validator/validation-validwhen.xml\" />\n-->\n    </plug-in>\n\t<plug-in className=\"org.apache.struts.tiles.TilesPlugin\">\n\t\t<set-property property=\"definitions-config\" value=\"/WEB-INF/tiles-definitions.xml\" />\n\t</plug-in>\n\n</struts-config>\n","markers":{"markers":{"1":{"id":1,"range":[[67,3],[67,3]],"tailed":false,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":113,"goalBufferRange":null},"deserializer":"Marker"},"9":{"id":9,"range":[[66,0],[67,49]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{},"deserializer":"Marker"},"10":{"id":10,"range":[[68,0],[68,11]],"tailed":true,"reversed":false,"valid":true,"invalidate":"never","persistent":true,"properties":{},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[{"patches":[{"oldRange":[[65,0],[69,0]],"newRange":[[65,0],[65,0]],"oldText":"        <action path=\"/enrollAgreement\" type=\"com.fis.cashlineapp.actions.EnrollAction\" name=\"enrollForm\" scope=\"request\" parameter=\"method\" input=\"/enrollAgreement.jsp\" validate=\"false\">\n            <forward name=\"success\" path=\"/enrollForm.jsp\" />\n            <forward name=\"fail\" path=\"/enrollForm.jsp\" />\n        </action>\n","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[69,0],[85,0]],"newRange":[[69,0],[69,0]],"oldText":"\t\t<action path=\"/enrollPerform\" type=\"com.fis.cashlineapp.actions.EnrollAction\" name=\"enrollForm\" scope=\"request\" parameter=\"method\" validate=\"true\" input=\"/enrollForm.jsp\">\n\t\t\t<forward name=\"success\" path=\"/enrollDetails.jsp\" />\n\t\t\t<forward name=\"enroll\" path=\"/enrollForm.jsp\" />\n\t\t\t<forward name=\"fail\" path=\"/enrollForm.jsp\" />\n\t\t</action>\n\n\t\t<action path=\"/enrollEdit\" type=\"com.fis.cashlineapp.actions.EnrollAction\" name=\"enrollForm\" scope=\"request\" parameter=\"method\" validate=\"false\" input=\"/archived/enroll/enroll-form.jsp\">\n\t\t\t<forward name=\"enroll\" path=\"/enrollForm.jsp\" />\n\t\t\t<forward name=\"fail\" path=\"/enrollForm.jsp\" />\n\t\t</action>\n\n\t\t<action path=\"/enrollSave\" type=\"com.fis.cashlineapp.actions.EnrollAction\" name=\"enrollForm\" scope=\"request\" parameter=\"method\" validate=\"true\" input=\"/enrollForm.jsp\">\n\t\t\t<forward name=\"success\" path=\"/enrollSuccess.jsp\" />\n\t\t\t<forward name=\"enroll\" path=\"/enrollForm.jsp\" />\n\t\t</action>\n\n","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"},{"id":1,"oldParams":{"tailed":true},"newParams":{"tailed":false},"deserializer":"MarkerPatch"}],"deserializer":"Transaction"},{"patches":[{"oldRange":[[69,0],[69,0]],"newRange":[[69,0],[70,0]],"oldText":"","newText":"\n","normalizeLineEndings":{},"markerPatches":{},"deserializer":"BufferPatch"},{"oldRange":[[70,0],[70,0]],"newRange":[[70,0],[70,0]],"oldText":"","newText":"","normalizeLineEndings":true,"markerPatches":{},"deserializer":"BufferPatch"}],"deserializer":"Transaction"}],"redoStack":[],"deserializer":"History"},"filePath":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/WebContent/WEB-INF/struts-config.xml","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"7bc182bb7301389cafd491e23a328f65a5f30304","deserializer":"TextBuffer"}],"deserializer":"Project"},"workspace":{"paneContainer":{"root":{"id":7,"items":[{"id":65,"softTabs":true,"displayBuffer":{"id":66,"softWrap":false,"editorWidthInChars":null,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/WebContent/add-ach-account.jsp","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"},{"id":69,"softTabs":true,"displayBuffer":{"id":70,"softWrap":false,"editorWidthInChars":null,"scrollTop":1293,"scrollLeft":1,"tokenizedBuffer":{"bufferPath":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/WebContent/enrollAgreement.jsp","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"},{"id":73,"softTabs":true,"displayBuffer":{"id":74,"softWrap":false,"editorWidthInChars":null,"scrollTop":9266,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/WebContent/enrollForm.jsp","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"},{"id":105,"softTabs":false,"displayBuffer":{"id":106,"softWrap":false,"editorWidthInChars":null,"scrollTop":10687,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"},{"id":113,"softTabs":false,"displayBuffer":{"id":114,"softWrap":false,"editorWidthInChars":null,"scrollTop":1430,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/WebContent/WEB-INF/struts-config.xml","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"}],"activeItemUri":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","focused":true,"deserializer":"Pane"},"activePaneId":7,"deserializer":"PaneContainer","version":1},"fullScreen":false,"packagesWithActiveGrammars":["language-html","language-javascript","language-java","language-xml"],"deserializer":"Workspace"},"packageStates":{"coffee-lint":{"height":0},"command-logger":{"eventLog":{"core:select-all":{"count":6,"name":"core:select-all","lastRun":1407695445241},"core:copy":{"count":8,"name":"core:copy","lastRun":1407695446378},"fuzzy-finder:toggle-file-finder":{"count":4,"name":"fuzzy-finder:toggle-file-finder","lastRun":1407695509203},"core:confirm":{"count":10,"name":"core:confirm","lastRun":1407698071776},"find-and-replace:show":{"count":2,"name":"find-and-replace:show","lastRun":1407694107649},"core:cancel":{"count":1,"name":"core:cancel","lastRun":1407694111612},"editor:move-to-first-character-of-line":{"count":4,"name":"editor:move-to-first-character-of-line","lastRun":1407695733798},"core:select-down":{"count":23,"name":"core:select-down","lastRun":1407695748717},"core:backspace":{"count":6,"name":"core:backspace","lastRun":1407697996573},"goto:file-symbol":{"count":3,"name":"goto:file-symbol","lastRun":1407698068557},"core:move-down":{"count":4,"name":"core:move-down","lastRun":1407695740238},"editor:newline":{"count":1,"name":"editor:newline","lastRun":1407695750564},"core:save":{"count":2,"name":"core:save","lastRun":1407697997765}}},"goto":{"entries":{"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java":[{"name":"EnrollAction","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":42,"column":13}},{"name":"Continue","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":45,"column":25}},{"name":"Load","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":49,"column":25}},{"name":"customValidateSave","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":90,"column":22}},{"name":"validateLoginInfo","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":153,"column":22}},{"name":"validatePersonalInfo","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":205,"column":22}},{"name":"validateAddressInfo","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":298,"column":22}},{"name":"validatePassword","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":344,"column":17}},{"name":"validateNumeric","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":353,"column":17}},{"name":"validateDateOfBirth","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":360,"column":17}},{"name":"validateExpiredDate","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":397,"column":17}},{"name":"Save","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":426,"column":22}},{"name":"Next","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":517,"column":22}},{"name":"Edit","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":567,"column":22}},{"name":"unspecified","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":670,"column":22}},{"name":"Submit","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":710,"column":22}},{"name":"prepareSuccessEnrollResponse","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":993,"column":16}},{"name":"prepareSuccessEnrollOTBOnlyResponse","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":1023,"column":16}},{"name":"prepareSuccessEnrollACHOptOutResponse","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":1053,"column":16}},{"name":"prepareSuccessSaveResponse","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":1083,"column":16}},{"name":"prepareDeclineEnrollResponse","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":1100,"column":16}},{"name":"validateCaptcha","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":1116,"column":17}},{"name":"loadSession","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":1124,"column":14}},{"name":"loadEnrollSession","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":1169,"column":14}},{"name":"populateEnrollHelper","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":1212,"column":22}},{"name":"prepareSystemErrorMessage","path":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java","position":{"row":1246,"column":16}}],"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/WebContent/WEB-INF/struts-config.xml":null,"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/WebContent/enrollForm.jsp":null}},"local-history":{"localHistoryViewState":""},"find-and-replace":{"viewState":{"findHistory":["continue"],"replaceHistory":[],"modelState":{"useRegex":false,"inCurrentSelection":false,"caseSensitive":false}}},"fuzzy-finder":{"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/WebContent/add-ach-account.jsp":1407693518366,"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/WebContent/enrollAgreement.jsp":1407695679129,"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/WebContent/enrollForm.jsp":1407697973420,"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource/com/fis/cashlineapp/actions/EnrollAction.java":1407698065917,"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/WebContent/WEB-INF/struts-config.xml":1407695725885},"keybinding-resolver":{"attached":false},"metrics":{"sessionLength":60211049},"tree-view":{"directoryExpansionStates":{"CashLine_UI":{"CashLineApp":{"WebContent":{}}}},"selectedPath":"/Users/bryce/Code/cashline-migration/CashLine_UI/CashLineApp/JavaSource","hasFocus":false,"attached":true,"scrollLeft":0,"scrollTop":199,"width":300}}}